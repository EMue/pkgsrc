$NetBSD: patch-ac,v 1.2 2001/05/01 16:13:54 jtb Exp $

--- itk/configure.orig	Tue Aug 29 03:58:00 2000
+++ itk/configure
@@ -1119,7 +1119,7 @@
     ;;
     *)
 	CYGPATH=echo
-	RELPATH=..
+	RELPATH=../..
     ;;
 esac
 
@@ -1871,20 +1871,20 @@
 # link against the non-stubbed Tcl library.
 #--------------------------------------------------------------------
 
-if test "${SHARED_BUILD}" = "1" ; then
-    cat >> confdefs.h <<\EOF
-#define USE_TCL_STUBS 1
-EOF
-
-    cat >> confdefs.h <<\EOF
-#define USE_TK_STUBS 1
-EOF
+#  if test "${SHARED_BUILD}" = "1" ; then
+#      cat >> confdefs.h <<\EOF
+#  #define USE_TCL_STUBS 1
+#  EOF
+
+#      cat >> confdefs.h <<\EOF
+#  #define USE_TK_STUBS 1
+#  EOF
+
+#      cat >> confdefs.h <<\EOF
+#  #define USE_ITCL_STUBS 1
+#  EOF
 
-    cat >> confdefs.h <<\EOF
-#define USE_ITCL_STUBS 1
-EOF
-
-fi
+#  fi
 
 #--------------------------------------------------------------------
 # This macro generates a line to use when building a library.  It
@@ -1902,7 +1902,7 @@
 	    ;;
 	*)
 	    MAKE_STATIC_LIB="\${STLIB_LD} \$@ \$(\$@_OBJECTS)"
-	    MAKE_SHARED_LIB="\${SHLIB_LD} -o \$@ \$(\$@_OBJECTS) \${SHLIB_LDFLAGS} \${SHLIB_LD_LIBS}"
+	    MAKE_SHARED_LIB="\${SHLIB_LD} -o \${@:C/\.so.*/.la/} \${\$@_OBJECTS:.o=.lo} \${SHLIB_LDFLAGS} \${SHLIB_LD_LIBS} -version-info 0:0"
 	    ;;
     esac
 
@@ -1941,7 +1941,7 @@
 	;;
     *)
 	if test "${SHARED_BUILD}" = "1" ; then
-	    SHLIB_LD_LIBS="${tkstub_LIB_SPEC} ${TCL_STUB_LIB_SPEC} ../itcl/${itclstub_LIB_FILE}"
+	    SHLIB_LD_LIBS="${tkstub_LIB_SPEC} ${TCL_STUB_LIB_SPEC} ../itcl/itclStubLib.lo"
 	    eval "${PACKAGE}_LIB_FILE=lib${PACKAGE}${SHARED_LIB_SUFFIX}"
 	    RANLIB=:
 	else
