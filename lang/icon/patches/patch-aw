$NetBSD: patch-aw,v 1.3 2001/06/25 18:00:17 jtb Exp $

--- src/common/Makefile.orig	Thu Jun  7 16:20:54 2001
+++ src/common/Makefile
@@ -5,7 +5,7 @@
 	munix.o literals.o rswitch.o alloc.o long.o getopt.o time.o\
 	save.o redirerr.o xwindow.o dlrgint.o ipp.o
 
-common:		doincl patchstr $(OBJS) xpmaybe
+common:		doincl patchstr $(OBJS) headers xpmaybe
 
 doincl:		doincl.c
 		$(CC) $(CFLAGS) -o doincl doincl.c
@@ -15,12 +15,22 @@
 		$(CC) $(CFLAGS) -o patchstr patchstr.c
 		cp patchstr ../../bin
 
+headers:
+		cd ../h; for f in *.h; do		\
+		sed -e 's:../h/::g;s:../xpm/::g' $$f >	\
+		../../lib/icon/$$f;			\
+		done
+
 xpmaybe:
 		-if [ "x$(XL)" != "x" ]; then $(MAKE) xpm; fi
 
 xpm:
 		cd ../xpm; $(MAKE) libXpm.a
-		cp ../xpm/libXpm.a ../../bin
+		cp ../xpm/libXpm.a ../../lib/icon
+		cd ../xpm; for f in *.h; do		\
+		sed -e 's:../h/::g;s:../xpm/::g' $$f >	\
+		../../lib/icon/$$f;			\
+		done
 
 $(OBJS): ../h/define.h ../h/config.h ../h/cstructs.h ../h/mproto.h \
 	  ../h/typedefs.h ../h/proto.h ../h/cpuconf.h
