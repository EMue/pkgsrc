$NetBSD: patch-aa,v 1.3 2000/07/12 20:08:12 jlam Exp $

--- configure.orig	Sun Sep 28 13:23:25 1997
+++ configure	Tue Jul 11 02:33:58 2000
@@ -1236,6 +1236,8 @@
 # It thinks the first close brace ends the variable substitution.
 test -z "$INSTALL_PROGRAM" && INSTALL_PROGRAM='${INSTALL}'
 
+test -z "$INSTALL_SCRIPT" && INSTALL_SCRIPT='${INSTALL}'
+
 test -z "$INSTALL_DATA" && INSTALL_DATA='${INSTALL} -m 644'
 
 
@@ -5845,7 +5847,7 @@
 if test "$enable_shared" = "yes" && test "x${TCL_SHLIB_SUFFIX}" != "x" ; then
   EXP_SHLIB_CFLAGS=$TCL_SHLIB_CFLAGS
 #  EXP_SHARED_LIB_FILE=libexpect$EXP_LIB_VERSION$TCL_SHLIB_SUFFIX
-  eval "EXP_SHARED_LIB_FILE=libexpect${TCL_SHARED_LIB_SUFFIX}"
+  eval "EXP_SHARED_LIB_FILE=libexpect`echo ${VERSION} | tr -d .`.so.1.2"
   EXP_LIB_FILE=$EXP_SHARED_LIB_FILE
   EXP_LIB_FILES="$EXP_SHARED_LIB_FILE $EXP_UNSHARED_LIB_FILE"
   echo "$ac_t""both shared and unshared" 1>&6
@@ -5862,6 +5864,15 @@
 EXP_AND_TCL_LIBS="$EXP_AND_TCL_LIBS $TCL_LD_SEARCH_FLAGS"
 EXP_AND_TK_LIBS="$EXP_AND_TK_LIBS $TCL_LD_SEARCH_FLAGS"
 
+# For NetBSD pkgsrc:
+# 
+# Pass correct flags to linker so that expect finds libraries at run-time.
+# The Tcl and Tk libraries are in ${LOCALBASE}/lib.  The X11 libraries are
+# in ${X11BASE}/lib.
+#
+EXP_AND_TCL_LIBS="-Wl,-R${LOCALBASE}/lib $EXP_AND_TCL_LIBS"
+EXP_AND_TK_LIBS="-Wl,-R${LOCALBASE}/lib -Wl,-R${X11BASE}/lib $EXP_AND_TK_LIBS"
+
 # Sigh - Tcl's defines SHLIB_LD_LIBS to be either empty or ${LIBS} and
 # LIBS is intended to be expanded by Make.  But since we're too close
 # to hitting config's max symbols, pack everything together here and
@@ -6008,17 +6019,18 @@
 s%@TCL_SHLIB_LD@%$TCL_SHLIB_LD%g
 s%@SHLIB_SUFFIX@%$SHLIB_SUFFIX%g
 s%@TCL_LD_FLAGS@%$TCL_LD_FLAGS%g
-s%@TCL_BUILD_LIB_SPEC@%$TCL_BUILD_LIB_SPEC%g
+s%@TCL_BUILD_LIB_SPEC@%$TCL_LIB_SPEC%g
 s%@TCL_LIB_SPEC@%$TCL_LIB_SPEC%g
 s%@TCL_SHARED_LIB_SUFFIX@%$TCL_SHARED_LIB_SUFFIX%g
 s%@TK_VERSION@%$TK_VERSION%g
 s%@TK_DEFS@%$TK_DEFS%g
 s%@TK_XINCLUDES@%$TK_XINCLUDES%g
 s%@TK_XLIBSW@%$TK_XLIBSW%g
-s%@TK_BUILD_LIB_SPEC@%$TK_BUILD_LIB_SPEC%g
+s%@TK_BUILD_LIB_SPEC@%$TK_LIB_SPEC%g
 s%@TK_LIB_SPEC@%$TK_LIB_SPEC%g
 s%@CC@%$CC%g
 s%@INSTALL_PROGRAM@%$INSTALL_PROGRAM%g
+s%@INSTALL_SCRIPT@%$INSTALL_SCRIPT%g
 s%@INSTALL_DATA@%$INSTALL_DATA%g
 s%@RANLIB@%$RANLIB%g
 s%@subdirs@%$subdirs%g
