$NetBSD: patch-ab,v 1.3 2000/12/19 07:03:22 jlam Exp $

--- configure.in.orig	Wed Dec 13 05:48:29 2000
+++ configure.in
@@ -137,12 +137,14 @@
 
 dnl Check for libwrap library.
 AC_MSG_CHECKING([for hosts_access in -lwrap])
+wrap_LIB=
 saved_LIBS="$LIBS"
 LIBS="-lwrap $saved_LIBS"
 AC_TRY_LINK([int hosts_access(); int allow_severity, deny_severity;],
 [hosts_access()],
-[AC_MSG_RESULT(yes); AC_DEFINE(HAVE_LIBWRAP)],
-[AC_MSG_RESULT(no)]; LIBS="$saved_LIBS")
+[AC_MSG_RESULT(yes); AC_DEFINE(HAVE_LIBWRAP) wrap_LIB="-lwrap"],
+[AC_MSG_RESULT(no)])
+LIBS="$saved_LIBS"
 
 dnl Add SSL includes and libraries
 CFLAGS="$CFLAGS -I$ssldir/include"
@@ -164,7 +166,7 @@
 # AC_HEADER_DIRENT
 # AC_HEADER_STDC
 # AC_HEADER_SYS_WAIT
-AC_CHECK_HEADERS(getopt.h unistd.h sys/select.h tcpd.h pthread.h pty.h stropts.h)
+AC_CHECK_HEADERS(getopt.h unistd.h sys/select.h tcpd.h pthread.h util.h sys/ioctl.h pty.h stropts.h)
 
 # dnl Checks for typedefs, structures, and compiler characteristics.
 # AC_C_CONST
@@ -175,6 +177,8 @@
 
 dnl Checks for library functions.
 AC_CHECK_FUNCS(getopt snprintf vsnprintf openpty _getpty daemon)
+
+LIBS="$LIBS $wrap_LIB"
 
 AC_OUTPUT(Makefile stunnel.8)
 
