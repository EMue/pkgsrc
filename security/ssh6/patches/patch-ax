$NetBSD: patch-ax,v 1.1 2000/03/20 02:25:41 itojun Exp $

--- cipher.c.orig	Wed May 12 07:19:24 1999
+++ cipher.c	Fri Dec 24 21:50:04 1999
@@ -213,7 +213,7 @@
 	 used. */
       if (keylen < 8)
 	error("Key length %d is insufficient for DES.", keylen);
-      des_set_key(padded, &context->u.des.key);
+      ssh_des_set_key(padded, &context->u.des.key);
       memset(context->u.des.iv, 0, sizeof(context->u.des.iv));
       break;
 #endif /* WITH_DES */
@@ -224,12 +224,12 @@
 	 used (first and last keys are the same). */
       if (keylen < 16)
 	error("Key length %d is insufficient for 3DES.", keylen);
-      des_set_key(padded, &context->u.des3.key1);
-      des_set_key(padded + 8, &context->u.des3.key2);
+      ssh_des_set_key(padded, &context->u.des3.key1);
+      ssh_des_set_key(padded + 8, &context->u.des3.key2);
       if (keylen <= 16)
-	des_set_key(padded, &context->u.des3.key3);
+	ssh_des_set_key(padded, &context->u.des3.key3);
       else
-	des_set_key(padded + 16, &context->u.des3.key3);
+	ssh_des_set_key(padded + 16, &context->u.des3.key3);
       memset(context->u.des3.iv1, 0, sizeof(context->u.des3.iv1));
       memset(context->u.des3.iv2, 0, sizeof(context->u.des3.iv2));
       memset(context->u.des3.iv3, 0, sizeof(context->u.des3.iv3));
@@ -274,12 +274,12 @@
 
 #ifdef WITH_DES
     case SSH_CIPHER_DES:
-      des_cbc_encrypt(&context->u.des.key, context->u.des.iv, dest, src, len);
+      ssh_des_cbc_encrypt(&context->u.des.key, context->u.des.iv, dest, src, len);
       break;
 #endif /* WITH_DES */
 
     case SSH_CIPHER_3DES:
-      des_3cbc_encrypt(&context->u.des3.key1, context->u.des3.iv1,
+      ssh_des_3cbc_encrypt(&context->u.des3.key1, context->u.des3.iv1,
 		       &context->u.des3.key2, context->u.des3.iv2,
 		       &context->u.des3.key3, context->u.des3.iv3,
 		       dest, src, len);
@@ -322,12 +322,12 @@
 
 #ifdef WITH_DES
     case SSH_CIPHER_DES:
-      des_cbc_decrypt(&context->u.des.key, context->u.des.iv, dest, src, len);
+      ssh_des_cbc_decrypt(&context->u.des.key, context->u.des.iv, dest, src, len);
       break;
 #endif /* WITH_DES */
 
     case SSH_CIPHER_3DES:
-      des_3cbc_decrypt(&context->u.des3.key1, context->u.des3.iv1,
+      ssh_des_3cbc_decrypt(&context->u.des3.key1, context->u.des3.iv1,
 		       &context->u.des3.key2, context->u.des3.iv2,
 		       &context->u.des3.key3, context->u.des3.iv3,
 		       dest, src, len);
