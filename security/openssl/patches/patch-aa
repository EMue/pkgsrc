$NetBSD: patch-aa,v 1.5 2001/01/17 10:09:51 wiz Exp $

--- config.orig	Mon Aug  9 05:16:51 1999
+++ config
@@ -155,8 +155,12 @@
         echo "${MACH}-${ARCH}-freebsd${VERS}"; exit 0
         ;;
 
-    NetBSD:*:*:*386*)
-        echo "`sysctl -n hw.model | sed 's,.*\(.\)86-class.*,i\186,'`-whateve\r-netbsd"; exit 0
+    NetBSD:*:*:i386)
+	if echo __ELF__ | cc -E - | grep -q __ELF__; then
+	    echo "i386-whatever-netbsd"; exit 0
+	else
+	    echo "i386elf-whatever-netbsd"; exit 0
+	fi
 	;;
 
     NetBSD:*)
@@ -324,6 +324,7 @@
   CC=cc
 fi
 
+if false; then
 if [ "$SYSTEM" = "SunOS" ]; then
   # check for WorkShop C, expected output is "cc: blah-blah C x.x"
   CCVER=`(cc -V 2>&1) 2>/dev/null | \
@@ -340,6 +341,7 @@
   elif [ "$CC" = "cc" -a $CCVER -gt 0 ]; then
     CC=sc3
   fi
+fi
 fi
 
 if [ "${SYSTEM}-${MACHINE}" = "Linux-alpha" ]; then
@@ -404,9 +408,9 @@
   alpha*-*-freebsd*) OUT="FreeBSD-alpha" ;;
   *-freebsd[3-9]*) OUT="FreeBSD-elf" ;;
   *-freebsd[1-2]*) OUT="FreeBSD" ;;
-  *86*-*-netbsd) OUT="NetBSD-x86" ;;
-  sun3*-*-netbsd) OUT="NetBSD-m68" ;;
-  *-*-netbsd) OUT="NetBSD-sparc" ;;
+  *86elf*-*-netbsd) OUT="NetBSD-i386elf" ;;
+  *86-*-netbsd) OUT="NetBSD-i386" ;;
+  *-netbsd) OUT="NetBSD-`sysctl -n hw.machine_arch`" ;;
   *86*-*-openbsd) OUT="OpenBSD-x86" ;;
   alpha*-*-openbsd) OUT="OpenBSD-alpha" ;;
   pmax*-*-openbsd) OUT="OpenBSD-mips" ;;
