$NetBSD: patch-aa,v 1.6 1999/04/03 13:44:24 tron Exp $

--- configure.orig	Tue Mar  9 07:53:50 1999
+++ configure	Sat Apr  3 15:35:29 1999
@@ -874,15 +874,12 @@
   withval="$with_tcl"
   TCL_BIN_DIR=$withval
 else
-  TCL_BIN_DIR=`cd ../../tcl8.0$TK_PATCH_LEVEL/unix; pwd`
+  TCL_BIN_DIR=${prefix}/lib/tcl8.0
 fi
 
 if test ! -d $TCL_BIN_DIR; then
     { echo "configure: error: Tcl directory $TCL_BIN_DIR doesn't exist" 1>&2; exit 1; }
 fi
-if test ! -f $TCL_BIN_DIR/Makefile; then
-    { echo "configure: error: There's no Makefile in $TCL_BIN_DIR;  perhaps you didn't specify the Tcl *build* directory (not the toplevel Tcl directory) or you forgot to configure Tcl?" 1>&2; exit 1; }
-fi
 
 #--------------------------------------------------------------------
 #	Read in configuration information generated by Tcl for shared
@@ -922,6 +919,8 @@
 CFLAGS_OPTIMIZE=$TCL_CFLAGS_OPTIMIZE
 EXTRA_CFLAGS=$TCL_EXTRA_CFLAGS
 
+TCL_SRC_DIR=${prefix}/include/tcl${TCL_VERSION}
+
 LIB_RUNTIME_DIR='${LIB_RUNTIME_DIR}'
 
 # If Tcl and Tk are installed in different places, adjust the library
@@ -2397,18 +2396,21 @@
     MAKE_LIB="ar cr \${TK_LIB_FILE} \${OBJS}"
 fi
 
-DBGX='${TK_DBGX}'
+DBGX=${TK_DBGX}
 eval "TK_LIB_FILE=${TK_LIB_FILE}"
 
+# Force the issue
+TK_SHARED_BUILD=1
+
 # Note:  in the following variable, it's important to use the absolute
 # path name of the Tcl directory rather than "..":  this is because
 # AIX remembers this path and will attempt to use it at run-time to look
 # up the Tcl library.
 
 if test "${TCL_LIB_VERSIONS_OK}" = "ok"; then
-    TK_LIB_FLAG="-ltk${VERSION}\${TK_DBGX}"
+    TK_LIB_FLAG="-ltk${VERSION}${TK_DBGX}"
 else
-    TK_LIB_FLAG="-ltk`echo ${VERSION} | tr -d .`\${TK_DBGX}"
+    TK_LIB_FLAG="-ltk`echo ${VERSION} | tr -d .`${TK_DBGX}"
 fi
 TK_BUILD_LIB_SPEC="-L`pwd` ${TK_LIB_FLAG}"
 TK_LIB_SPEC="-L${exec_prefix}/lib ${TK_LIB_FLAG}"
@@ -2598,6 +2600,7 @@
 s%@SHLIB_VERSION@%$SHLIB_VERSION%g
 s%@TCL_BIN_DIR@%$TCL_BIN_DIR%g
 s%@TCL_BUILD_LIB_SPEC@%$TCL_BUILD_LIB_SPEC%g
+s%@TCL_LIB_SPEC@%$TCL_LIB_SPEC%g
 s%@TCL_DBGX@%$TCL_DBGX%g
 s%@TCL_LIB_FLAG@%$TCL_LIB_FLAG%g
 s%@TCL_SRC_DIR@%$TCL_SRC_DIR%g
