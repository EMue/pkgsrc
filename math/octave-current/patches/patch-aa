$NetBSD: patch-aa,v 1.3 2001/04/22 20:23:02 jtb Exp $

--- configure.orig	Sun Apr 22 20:22:10 2001
+++ configure	Sun Apr 22 20:33:23 2001
@@ -799,9 +799,9 @@
 ### Allow the user disable support for command line editing using GNU
 ### readline.
 
-READLINE_DIR=readline
+READLINE_DIR=""
 USE_READLINE=true
-LIBREADLINE='$(TOPDIR)/readline/libreadline.$(LIBEXT)'
+LIBREADLINE='${LOCALBASE}/lib/libreadline.so'
 # Check whether --enable-readline or --disable-readline was given.
 if test "${enable_readline+set}" = set; then
   enableval="$enable_readline"
@@ -821,7 +821,7 @@
 
 
 
-LIBKPATHSEA='$(TOPDIR)/kpathsea/libkpathsea.$(LIBEXT)'
+LIBKPATHSEA='$(TOPDIR)/kpathsea/libkpathsea.a'
 
 
 ### Make it possible to have Octave's array and matrix classes do bounds
@@ -2414,7 +2414,7 @@
   echo "$ac_t""defining F77 to be $F77" 1>&6
 elif $use_g77; then
   if test "$with_g77" = yes; then
-    F77=g77
+    F77=${CC}
   else
     F77="$with_g77"
   fi
@@ -2704,13 +2704,8 @@
 
 
 
-if test "$cross_compiling" = yes; then
+if true "$cross_compiling" = yes; then
   octave_cv_f2c_f77_compat=yes
-  if test "$octave_cv_f77_is_g77" = yes; then
-    echo "$ac_t""assuming ${F77-f77} cross compiler is f2c compatible" 1>&6
-  else
-    echo "configure: warning: assuming ${F77-f77} cross compiler is f2c compatible" 1>&2
-  fi
 else
   echo $ac_n "checking ${F77-f77}/f2c compatibility""... $ac_c" 1>&6
 echo "configure:2717: checking ${F77-f77}/f2c compatibility" >&5
@@ -2755,7 +2750,7 @@
 }
 #if defined (sun)
 int MAIN_ () { return 0; }
-#elif defined (linux) && defined (__ELF__)
+#elif (defined (linux) && defined (__ELF__)) || defined (__NetBSD)
 int MAIN__ () { return 0; }
 #endif
 EOF
@@ -2844,10 +2839,8 @@
 %.c : %.f
 
 %.o : %.f
-	$(FC) -c $(ALL_FFLAGS) -o $@ $<
+	${LIBTOOL} --mode=compile $(FC) -c $(ALL_FFLAGS) $<
 
-pic/%.o : %.f
-	$(FC) -c $(FPICFLAG) $(ALL_FFLAGS) $< -o $@
 
 EOF
 elif $have_f2c; then
@@ -3026,11 +3019,11 @@
 fi
 
 FORTRAN_MAIN_FLAG=
-case "$canonical_host_type" in
-  *-linux-*)
-    FORTRAN_MAIN_FLAG="-u MAIN__"
-  ;;
-esac
+if test "${OBJECT_FMT}" = "ELF"; then
+FORTRAN_MAIN_FLAG="-u MAIN__"
+else
+FORTRAN_MAIN_FLAG="-Wl,-u_MAIN__"
+fi
 if test -n "$FORTRAN_MAIN_FLAG"; then
   echo "$ac_t""defining FORTRAN_MAIN_FLAG to be $FORTRAN_MAIN_FLAG" 1>&6
 fi
@@ -5145,7 +5138,7 @@
 
 GLOB_DIR=glob
 LIBGLOB='$(TOPDIR)/glob/glob.o $(TOPDIR)/glob/fnmatch.o'
-GLOB_INCFLAGS='-I$(top_srcdir)/glob -I$(TOPDIR)/glob'
+GLOB_INCFLAGS='-I$(top_srcdir)/glob -I$(TOPDIR)/glob -I${LOCALBASE}/include'
 if test "$ac_cv_header_fnmatch_h" = yes \
   && test "$ac_cv_header_glob_h" = yes; then
   cat > conftest.$ac_ext <<EOF
@@ -6305,7 +6298,7 @@
 
 
 TERMLIBS=""
-for termlib in ncurses curses termcap terminfo termlib; do
+for termlib in curses termcap termlib; do
   echo $ac_n "checking for tputs in -l${termlib}""... $ac_c" 1>&6
 echo "configure:6311: checking for tputs in -l${termlib}" >&5
 ac_lib_var=`echo ${termlib}'_'tputs | sed 'y%./+-%__p_%'`
@@ -6356,13 +6349,11 @@
 
 
 if test "$ac_cv_lib_termcap_tputs" = yes \
-    || test "$ac_cv_lib_terminfo_tputs" = yes \
-    || test "$ac_cv_lib_ncurses_tputs" = yes \
     || test "$ac_cv_lib_curses_tputs" = yes \
     || test "$ac_cv_lib_termlib_tputs" = yes; then
   true
 else
-  warn_termlibs="I couldn't find -ltermcap, -lterminfo, -lncurses, -lcurses, or -ltermlib!"
+  warn_termlibs="I couldn't find -ltermcap, -lcurses, or -ltermlib!"
   echo "configure: warning: $warn_termlibs" 1>&2
 fi
 
@@ -7069,19 +7060,19 @@
     cat << \EOF > $bsd_gcc_kluge_targets_frag
 
 lex.o: lex.cc 
-	$(CXX) -c $(CPPFLAGS) $(CXXFLAGS_NO_PT_FLAGS) $<
+	${LIBTOOL} --mode=compile $(CXX) -c $(CPPFLAGS) $(CXXFLAGS_NO_PT_FLAGS) $<
 
 pt-plot.o: pt-plot.cc
-	$(CXX) -c $(CPPFLAGS) $(CXXFLAGS_NO_PT_FLAGS) $<
+	${LIBTOOL} --mode=compile $(CXX) -c $(CPPFLAGS) $(CXXFLAGS_NO_PT_FLAGS) $<
 
 symtab.o: symtab.cc
-	$(CXX) -c $(CPPFLAGS) $(CXXFLAGS_NO_PT_FLAGS) $<
+	${LIBTOOL} --mode=compile $(CXX) -c $(CPPFLAGS) $(CXXFLAGS_NO_PT_FLAGS) $<
 
 toplev.o: toplev.cc
-	$(CXX) -c $(CPPFLAGS) $(CXXFLAGS_NO_PT_FLAGS) $<
+	${LIBTOOL} --mode=compile $(CXX) -c $(CPPFLAGS) $(CXXFLAGS_NO_PT_FLAGS) $<
 
 unwind-prot.o: unwind-prot.cc 
-	$(CXX) -c $(CPPFLAGS) $(CXXFLAGS_NO_PT_FLAGS) $<
+	${LIBTOOL} --mode=compile $(CXX) -c $(CPPFLAGS) $(CXXFLAGS_NO_PT_FLAGS) $<
 
 EOF
   ;;
@@ -7350,7 +7341,7 @@
 # ./install, which can be erroneously created by make from ./install.sh.
 echo $ac_n "checking for a BSD compatible install""... $ac_c" 1>&6
 echo "configure:7353: checking for a BSD compatible install" >&5
-if test -z "$INSTALL"; then
+if true; then
 if eval "test \"`echo '$''{'ac_cv_path_install'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -7994,7 +7985,7 @@
 done
 
 ac_given_srcdir=$srcdir
-ac_given_INSTALL="$INSTALL"
+ac_given_INSTALL="${INSTALL}"
 
 trap 'rm -fr `echo "Makefile octMakefile Makeconf install-octave \
   test/Makefile dlfcn/Makefile \
@@ -8237,10 +8228,6 @@
     top_srcdir="$ac_dots$ac_given_srcdir" ;;
   esac
 
-  case "$ac_given_INSTALL" in
-  [/$]*) INSTALL="$ac_given_INSTALL" ;;
-  *) INSTALL="$ac_dots$ac_given_INSTALL" ;;
-  esac
 
   echo creating "$ac_file"
   rm -f "$ac_file"
