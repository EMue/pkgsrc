$NetBSD: patch-ch,v 1.1 1998/08/25 12:53:14 agc Exp $

--- routines/control/wsvdc.f.orig	Thu Aug 20 17:03:55 1998
+++ routines/control/wsvdc.f	Fri Aug 21 10:22:48 1998
@@ -129,5 +129,5 @@
 c     small number, roughly machine epsilon, used to avoid underflow
 c    
-      small = 1.0d-18
+      small = 4.0d-16
 c
 c     determine what is to be computed.
@@ -409,5 +409,5 @@
             test = abs(sr(l)) + abs(sr(l+1))
             ztest = test + abs(er(l))/2.0d+0
-            if (small*ztest .ne. small*test) go to 460
+            if (abs(ztest-test) .gt. small*abs(test)) go to 460
                er(l) = 0.0d+0
 c        ......exit
@@ -430,5 +430,5 @@
                if (ls .ne. l + 1) test = test + abs(er(ls-1))
                ztest = test + abs(sr(ls))/2.0d+0
-               if (small*ztest .ne. small*test) go to 500
+            if (abs(ztest-test) .gt. small*abs(test)) go to 500
                   sr(ls) = 0.0d+0
 c           ......exit
