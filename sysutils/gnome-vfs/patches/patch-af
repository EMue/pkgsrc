$NetBSD: patch-af,v 1.1 2001/04/06 22:03:09 rh Exp $

--- libgnomevfs-pthread/gnome-vfs-job-slave.c.orig	Thu Apr  5 17:55:16 2001
+++ libgnomevfs-pthread/gnome-vfs-job-slave.c
@@ -60,14 +60,22 @@
 	}
 	
 	JOB_DEBUG (("locking access_lock %u", GPOINTER_TO_UINT (job->job_handle)));
+#ifdef HAVE_SEMAPHORE_H
 	sem_wait (&job->access_lock);
+#else
+	pthread_mutex_lock (&job->access_lock);
+#endif
 	gnome_vfs_async_job_map_unlock ();
 
 	gnome_vfs_job_execute (job);
 	complete = gnome_vfs_job_complete (job);
 	
 	JOB_DEBUG (("Unlocking access lock %u", GPOINTER_TO_UINT (job->job_handle)));
+#ifdef HAVE_SEMAPHORE_H
 	sem_post (&job->access_lock);
+#else
+	pthread_mutex_unlock (&job->access_lock);
+#endif
 
 	if (complete) {
 		JOB_DEBUG (("job %u done, removing from map and destroying",
