#!/bin/sh
#
# $NetBSD: INSTALL,v 1.2 2000/08/17 02:40:45 hubertf Exp $

PKGNAME=$1
STAGE=$2

AMUSER=@AMUSER@
AMGROUP=@AMGROUP@
ADDUSER=@ADDUSER@
ADDGROUP=@ADDGROUP@

case ${STAGE} in
PRE-INSTALL)
	# Group... the default's shipped with NetBSD
	# We need to check that ${AMGROUP} exists before adding the user.
	#
	if grep -q "^${AMGROUP}:" /etc/group
	then
		echo "Group '${AMGROUP}' already exists...proceeding."
	else
		echo "Creating '${AMGROUP}' group..."
		${ADDGROUP} ${AMGROUP}
		echo "Done."
	fi

	# use finger to be able to use NIS, ...
	#
	if finger ${AMUSER} 2>&1 | grep >/dev/null "no such user"
	then
		echo "Creating '${AMUSER}' user..."
		${ADDUSER} -c "Amanda User" -g ${AMGROUP} -s /bin/sh ${AMUSER}
		echo "Done."
	else
		echo "User '${AMUSER}' already exists...proceeding."
	fi
	;;
POST-INSTALL)
	;;
*)
	echo "Unexpected argument: $2"
	exit 1
	;;
esac
exit 0
