$NetBSD: patch-af,v 1.2 2000/10/02 16:43:45 abs Exp $

--- src/log.c.orig	Mon Oct  2 17:38:13 2000
+++ src/log.c
@@ -71,12 +71,12 @@
 		     
 		     if (LOGGING && (getuid() == 0))
 			{
-			syslog(LOG_ERR,string,VFQNAME);
+			syslog(LOG_ERR,"%s",string,VFQNAME);
 
 			if (strlen(errstr) != 0)
 			   {
-			   syslog(LOG_ERR,errstr,VFQNAME);
-			   syslog(LOG_ERR,strerror(errno),VFQNAME);
+			   syslog(LOG_ERR,"%s",errstr,VFQNAME);
+			   syslog(LOG_ERR,"%s",strerror(errno),VFQNAME);
 			   }
 			}
                      break;
@@ -110,11 +110,11 @@
    case cflogonly:
                      if (LOGGING && getuid() == 0)
 			{
-			syslog(LOG_INFO,string,VFQNAME);
+			syslog(LOG_INFO,"%s",string,VFQNAME);
 			
 			if ((errstr == NULL) || (strlen(errstr) > 0))
 			   {
-			   syslog(LOG_ERR,errstr,VFQNAME);
+			   syslog(LOG_ERR,"%s",errstr,VFQNAME);
 			   }
 			}
 		     
@@ -125,7 +125,7 @@
 
 		     if (LOGGING && (getuid() == 0))
 			{
-			syslog(LOG_ERR,string,VFQNAME);
+			syslog(LOG_ERR,"%s",string,VFQNAME);
 			}
  
 		     if (string[strlen(string)-1] != '\n')
@@ -141,8 +141,8 @@
 			
 			if (LOGGING && (getuid() == 0))
 			   {
-			   syslog(LOG_ERR,errstr,VFQNAME);
-			   syslog(LOG_ERR,strerror(errno),VFQNAME);
+			   syslog(LOG_ERR,"%s",errstr,VFQNAME);
+			   syslog(LOG_ERR,"%s",strerror(errno),VFQNAME);
 			   }
                         }
 		     return;
