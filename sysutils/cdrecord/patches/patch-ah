$NetBSD: patch-ah,v 1.1 2000/11/21 23:37:02 mycroft Exp $

--- cdda2wav/setuid.c.orig	Sat Apr 22 20:37:57 2000
+++ cdda2wav/setuid.c	Tue Nov 21 23:30:58 2000
@@ -93,7 +93,7 @@
     }
     if (geteuid() == 0) return; /* nothing to do */
 
-#if defined _POSIX_SAVED_IDS && defined (HAVE_SETEUID)
+#if defined (HAVE_SETEUID)
     if (seteuid(effective_uid)) {
 	perror("seteuid in needroot()");
 	exit(1);
@@ -127,7 +127,7 @@
     }
     if (geteuid() != 0) return; /* nothing to do */
 
-#if defined _POSIX_SAVED_IDS && defined (HAVE_SETEUID)
+#if defined (HAVE_SETEUID)
     if (seteuid(real_uid)) {
 	perror("seteuid in dontneedroot()");
 	exit(1);
@@ -185,7 +185,7 @@
 
     if (getegid() == effective_gid) return; /* nothing to do */
 
-#if defined _POSIX_SAVED_IDS && defined (HAVE_SETEGID)
+#if defined (HAVE_SETEGID)
     if (setegid(effective_gid)) {
 	perror("setegid in needgroup()");
 	exit(1);
@@ -216,7 +216,7 @@
 	exit(1);
     }
     if (getegid() != effective_gid) return; /* nothing to do */
-#if defined _POSIX_SAVED_IDS && defined (HAVE_SETEGID)
+#if defined (HAVE_SETEGID)
     if (setegid(real_gid)) {
 	perror("setegid in dontneedgroup()");
 	exit(1);
--- misc/readcd.c.orig	Thu Jul 20 16:18:45 2000
+++ misc/readcd.c	Tue Nov 21 23:31:13 2000
@@ -293,11 +293,11 @@
 	/*
 	 * We don't need root privilleges anymore.
 	 */
-#ifdef	HAVE_SETREUID
-	if (setreuid(-1, getuid()) < 0)
-#else
 #ifdef	HAVE_SETEUID
 	if (seteuid(getuid()) < 0)
+#else
+#ifdef	HAVE_SETREUID
+	if (setreuid(-1, getuid()) < 0)
 #else
 	if (setuid(getuid()) < 0)
 #endif
--- mkisofs/mkisofs.c.orig	Thu Jul 20 16:31:17 2000
+++ mkisofs/mkisofs.c	Tue Nov 21 23:31:20 2000
@@ -1802,11 +1802,11 @@
 		}
 	}
 	/* We don't need root privilleges anymore. */
-#ifdef	HAVE_SETREUID
-	if (setreuid(-1, getuid()) < 0)
-#else
 #ifdef	HAVE_SETEUID
 	if (seteuid(getuid()) < 0)
+#else
+#ifdef	HAVE_SETREUID
+	if (setreuid(-1, getuid()) < 0)
 #else
 	if (setuid(getuid()) < 0)
 #endif
