$NetBSD: patch-ag,v 1.2 2000/02/29 18:31:30 jlam Exp $

--- src/pkg/common/unix/scripts/install.sh.orig	Wed Jun  2 16:19:32 1999
+++ src/pkg/common/unix/scripts/install.sh	Tue Feb 29 12:17:41 2000
@@ -2,14 +2,14 @@
 #
 # This script is invoked by the Makefiles when the "install" target
 # is specified.  It just puts things where most users will probably
-# be happy, in $TARGET, with symbolic links (in $BINDIR) to the binaries
-# in $TARGET/bin
+# be happy, in $TARGET, with the binaries in $LIBEXECDIR, with
+# symbolic links (in $BINDIR) to the binaries in $LIBEXECDIR.
 # 
 # $SRCDIR should be the place where the compile process (the "canonical"
 # target especially) put all the stuff.  $SCRIPTDIR should be set by the 
 # caller so we can know where we are.  $BINDIR is where the symbolic
-# links are eventually installed, to point to the "bin/*" files within
-# $TARGET/bin
+# links are eventually installed, to point to the executable files within
+# $LIBEXECDIR
 
 # if no target, bail
 if [ -z "$TARGET" ]
@@ -52,6 +52,21 @@
     exit 1
 fi
 
+# Make sure the libexec dir exists
+if [ -z "$LIBEXECDIR" ]
+then
+    LIBEXECDIR=${TARGET}/bin
+fi
+mkdir -p $LIBEXECDIR
+
+if [ ! -d $LIBEXECDIR ]
+then
+    echo ""
+    echo "Error creating directory [$LIBEXECDIR]."
+    echo ""
+    exit 1
+fi
+
 # start with breathing room
 echo ""
 
@@ -63,9 +78,9 @@
 # Copy the files from $SRCDIR to $TARGET
 (cd $SRCDIR/AbiSuite; tar cf - *) | (cd $TARGET; tar xf -)
 
-echo "Installing program binaries to [$TARGET/bin]..."
+echo "Installing program binaries to [$LIBEXECDIR]..."
 # Setup bins 
-(cd $SRCDIR; tar cf - bin/Abi*) | (cd $TARGET; tar xf -)
+(cd $SRCDIR/bin; tar cf - Abi*) | (cd $LIBEXECDIR; tar xf -)
 
 ########################################################################
 # If we're on Solaris, run makepsres on the font path
@@ -91,10 +106,10 @@
 cd $SCRIPTDIR
 
 echo "Making wrapper script at [$TARGET/bin/AbiWord]..."
-./makewrapper.sh AbiWord $TARGET
+./makewrapper.sh AbiWord $TARGET $LIBEXECDIR
 # TODO : make use of these
-# ./makewrapper.sh AbiCalc $TARGET
-# ./makewrapper.sh AbiFile $TARGET
+# ./makewrapper.sh AbiCalc $TARGET $LIBEXECDIR
+# ./makewrapper.sh AbiFile $TARGET $LIBEXECDIR
 
 
 ########################################################################
@@ -107,12 +122,12 @@
 
 # NOTE : Solaris ln doesn't seem to honor the -f (force flag), so
 # NOTE : we have to remove them first.
-rm -f $BINDIR/AbiWord ; ln -s $TARGET/bin/AbiWord $BINDIR/AbiWord
-rm -f $BINDIR/abiword ; ln -s $TARGET/bin/AbiWord $BINDIR/abiword
+rm -f $BINDIR/AbiWord ; ln -s $LIBEXECDIR/AbiWord $BINDIR/AbiWord
+rm -f $BINDIR/abiword ; ln -s $LIBEXECDIR/AbiWord $BINDIR/abiword
 
 # TODO : make use of these, etc.
-# rm -f $BINDIR/AbiCalc ; ln -s $TARGET/bin/AbiCalc $LINK_DIR/AbiCalc
-# rm -f $BINDIR/abicalc ; ln -s $TARGET/bin/AbiCalc $LINK_DIR/abicalc
+# rm -f $BINDIR/AbiCalc ; ln -s $LIBEXECDIR/AbiCalc $LINK_DIR/AbiCalc
+# rm -f $BINDIR/abicalc ; ln -s $LIBEXECDIR/AbiCalc $LINK_DIR/abicalc
 
 ########################################################################
 # Done
