--- pico/makefile.neb.orig	Fri Apr  5 11:07:56 1996
+++ pico/makefile.neb	Sat Jun  6 07:21:14 1998
@@ -30,3 +30,3 @@
 #includes symbol info for debugging 
-DASHO=		-g
+DASHO=		-O2# -g
 #for normal build
@@ -35,3 +35,3 @@
 STDCFLAGS=	-Dneb -DJOB_CONTROL -DANSI -DPOSIX -DMOUSE
-CFLAGS=		$(EXTRACFLAGS) $(DASHO) $(STDCFLAGS)
+CFLAGS+=		$(EXTRACFLAGS) $(DASHO) $(STDCFLAGS)
 
@@ -48,2 +48,5 @@
 
+# Lets be elite and not retype in the above
+SOFILES=	${OFILES:.o=.so}
+
 CFILES=		attach.c ansi.c basic.c bind.c browse.c buffer.c \
@@ -54,2 +57,4 @@
 
+# Need this for the shared library rule to work correctly
+.SUFFIXES: .o .so
 
@@ -72,7 +77,12 @@
 
+libpico.so.1.3:	osdep.c osdep.h $(SOFILES)
+		ld -Bshareable -x -o libpico.so.1.3 $(SOFILES)
+ 
 pico:		main.c libpico.a
-		$(CC) $(CFLAGS) main.c libpico.a $(LIBS) -o pico
+		$(CC) $(CFLAGS) main.c -L. -lpico $(LIBS) -o pico
 
 pilot:		pilot.c libpico.a
-		$(CC) $(CFLAGS) pilot.c libpico.a $(LIBS) -o pilot
+		$(CC) $(CFLAGS) pilot.c -L. -lpico $(LIBS) -o pilot
+ 
+.c.so:		; $(CC) -fPIC -DPIC -c $(CFLAGS) ${@:.so=.c} -o $@
 
@@ -82,3 +92,5 @@
 
+$(SOFILES):	$(HFILES)
+ 
 clean:
-		rm -f *.a *.o *~ osdep.c osdep.h pico pilot
+		rm -f *.a *.so.1.3 *.o *.so *~ osdep.c osdep.h pico pilot
