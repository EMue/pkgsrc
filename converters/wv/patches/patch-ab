$NetBSD: patch-ab,v 1.3 2000/10/16 15:14:23 rh Exp $

--- configure.orig	Tue Sep 19 21:38:01 2000
+++ configure
@@ -3567,7 +3567,7 @@
 _SAVE_LDFLAGS=$LDFLAGS
 
 if test "$TTF_DIR" != "" ; then
-CFLAGS="-I${TTF_DIR}/include $CFLAGS"
+CFLAGS="-I${TTF_DIR}/include/freetype $CFLAGS"
 LDFLAGS="-L${TTF_DIR}/lib $LDFLAGS"
 fi
 
@@ -3602,7 +3602,7 @@
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   ac_save_LIBS="$LIBS"
-LIBS="-lttf -lm $LIBS"
+LIBS="-lttf -lintl -lm $LIBS"
 cat > conftest.$ac_ext <<EOF
 #line 3608 "configure"
 #include "confdefs.h"
@@ -3630,7 +3630,7 @@
 fi
 if eval "test \"`echo '$ac_cv_lib_'$ac_lib_var`\" = yes"; then
   echo "$ac_t""yes" 1>&6
-  TTF_LIBS="-lttf"
+  TTF_LIBS="-lttf -lintl"
 else
   echo "$ac_t""no" 1>&6
 no_ttf=yes
@@ -3641,14 +3641,14 @@
 fi
 
 if  test -n "${TTF_DIR}" && test -d "${TTF_DIR}" && test "$SYSTEM_TTF" = 1 ; then
-    TTF_CFLAGS="-I${TTF_DIR}/include"
+    TTF_CFLAGS="-I${TTF_DIR}/include/freetype"
     TTF_LIBS="-L${TTF_DIR}/lib ${TTF_LIBS}"
 fi
 
 if test "x$no_ttf" = xyes; then
 	if test "$TTF_DIR" != "" ; then
-	CFLAGS="-I${TTF_DIR} $CFLAGS"
-	LDFLAGS="-L${TTF_DIR} $LDFLAGS"
+	CFLAGS="-I${TTF_DIR}/include/freetype $CFLAGS"
+	LDFLAGS="-L${TTF_DIR}/lib $LDFLAGS"
 	fi
 
 	if test "$TTF_DIR" = no; then
@@ -3684,7 +3684,7 @@
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   ac_save_LIBS="$LIBS"
-LIBS="-lttf -lm $LIBS"
+LIBS="-lttf -lintl -lm $LIBS"
 cat > conftest.$ac_ext <<EOF
 #line 3690 "configure"
 #include "confdefs.h"
@@ -3712,7 +3712,7 @@
 fi
 if eval "test \"`echo '$ac_cv_lib_'$ac_lib_var`\" = yes"; then
   echo "$ac_t""yes" 1>&6
-  TTF_LIBS="-lttf"
+  TTF_LIBS="-lttf -lintl"
 else
   echo "$ac_t""no" 1>&6
 no_ttf=yes
@@ -3724,8 +3724,8 @@
 
 
 if  test -n "${TTF_DIR}" && test -d "${TTF_DIR}" && test "$SYSTEM_TTF" = 1 ; then
-    TTF_CFLAGS="-I${TTF_DIR}"
-    TTF_LIBS="-L${TTF_DIR} ${TTF_LIBS}"
+    TTF_CFLAGS="-I${TTF_DIR}/include/freetype"
+    TTF_LIBS="-L${TTF_DIR}/lib ${TTF_LIBS}"
 fi
 
 fi
@@ -3747,7 +3747,7 @@
 _SAVE_LIBS=$LIBS
 
 if test "$WMF_DIR" != "" ; then
-CFLAGS="-I${WMF_DIR}/include $CFLAGS"
+CFLAGS="-I${WMF_DIR}/include/libwmf $CFLAGS"
 LDFLAGS="-L${WMF_DIR}/lib $LDFLAGS"
 fi
 
@@ -3813,7 +3813,7 @@
 fi
 if eval "test \"`echo '$ac_cv_lib_'$ac_lib_var`\" = yes"; then
   echo "$ac_t""yes" 1>&6
-  WMF_LIBS="-lgdwmf -lwmf -lxgd -ldib -lpng"
+  WMF_LIBS="-lgdwmf -lwmf -lttf -lxgd -ldib -lpng"
 else
   echo "$ac_t""no" 1>&6
 no_wmf=yes
@@ -3824,7 +3824,7 @@
 fi
 
 if  test -n "${WMF_DIR}" && test -d "${WMF_DIR}" && test "$SYSTEM_WMF" = 1 ; then
-    WMF_CFLAGS="-I${WMF_DIR}/include"
+    WMF_CFLAGS="-I${WMF_DIR}/include/libwmf"
     WMF_LIBS="-L${WMF_DIR}/lib ${WMF_LIBS}"
 fi
 
@@ -3869,7 +3869,7 @@
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   ac_save_LIBS="$LIBS"
-LIBS="-lgdwmf -lwmf -lxgd -ldib -lpng $TTF_LIBS $XPM_LIBS $X_LIBS -lX11 $X_EXTRA_LIBS -lm $LIBS"
+LIBS="-lgdwmf -lwmf -lttf -lxgd -ldib -lpng $TTF_LIBS $XPM_LIBS $X_LIBS -lX11 $X_EXTRA_LIBS -lm $LIBS"
 cat > conftest.$ac_ext <<EOF
 #line 3875 "configure"
 #include "confdefs.h"
@@ -3909,8 +3909,8 @@
 
 
 if  test -n "${WMF_DIR}" && test -d "${WMF_DIR}" && test "$SYSTEM_WMF" = 1 ; then
-    WMF_CFLAGS="-I${WMF_DIR}"
-    WMF_LIBS="-L${WMF_DIR} ${WMF_LIBS}"
+    WMF_CFLAGS="-I${WMF_DIR}/include/libwmf"
+    WMF_LIBS="-L${WMF_DIR}/lib ${WMF_LIBS}"
 fi
 
 fi
@@ -5425,11 +5425,11 @@
 		echo $ac_n "checking if PNG package is complete""... $ac_c" 1>&6
 echo "configure:5427: checking if PNG package is complete" >&5
 		if test $passed -gt 0; then
-			if test $failed -gt 0; then
+			if false; then
 				echo "$ac_t""no -- some components failed test" 1>&6
 				have_png='no (failed tests)'
 			else
-				LIB_PNG='-lpng'
+				LIB_PNG='-lpng -lz'
 				cat >> confdefs.h <<\EOF
 #define HasPNG 1
 EOF
