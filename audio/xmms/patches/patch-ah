$NetBSD: patch-ah,v 1.3 2001/05/20 20:52:24 rh Exp $

--- libxmms/util.c.orig	Mon Oct  2 17:28:41 2000
+++ libxmms/util.c
@@ -68,7 +68,7 @@
 
 gboolean xmms_check_realtime_priority(void)
 {
-#ifdef HAVE_SCHED_SETSCHEDULER
+#if !defined(__NetBSD__) && defined(HAVE_SCHED_SETSCHEDULER)
 #ifdef __FreeBSD__
 	/*
 	 * Check if priority scheduling is enabled in the kernel
@@ -94,11 +94,22 @@
 #ifdef HAVE_NANOSLEEP
 	struct timespec req;
 
+#ifdef __NetBSD__
+	unsigned long n = usec / 50000;
+	usec %= 50000;
+	do {
+#endif
+
 	req.tv_sec = usec / 1000000;
 	usec -= req.tv_sec * 1000000;
 	req.tv_nsec = usec * 1000;
 
 	nanosleep(&req, NULL);
+
+#ifdef __NetBSD__
+	pthread_yield_np();
+	} while (n--);
+#endif
 #else
 	struct timeval tv;
 	
