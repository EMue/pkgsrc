--- linux_a.c	Mon May 20 15:09:46 1996
+++ ./linux_a.c	Wed Oct 29 01:09:19 1997
@@ -32,6 +32,16 @@
 #include <linux/soundcard.h>
 #endif
 
+#ifdef __NetBSD__
+#include <sys/ioctl.h>
+#include <soundcard.h>
+#undef EINTR
+#define EINTR EWOULDBLOCK
+#define DEV "/dev/audio"
+#else
+#define DEV "/dev/dsp"
+#endif
+
 #ifdef __FreeBSD__
 #include <stdio.h>
 #include <machine/soundcard.h>
@@ -56,7 +66,7 @@
   -1,
   {0}, /* default: get all the buffer fragments you can */
   "Linux dsp device", 'd',
-  "/dev/dsp",
+  DEV,
   open_output,
   close_output,
   output_data,
@@ -220,10 +230,10 @@
 
 static void flush_output(void)
 {
-  ioctl(dpm.fd, SNDCTL_DSP_SYNC);
+  ioctl(dpm.fd, SNDCTL_DSP_SYNC, 0);
 }
 
 static void purge_output(void)
 {
-  ioctl(dpm.fd, SNDCTL_DSP_RESET);
+  ioctl(dpm.fd, SNDCTL_DSP_RESET, 0);
 }
