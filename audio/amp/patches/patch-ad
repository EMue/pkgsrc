$NetBSD: patch-ad,v 1.2 1998/08/07 10:35:53 agc Exp $

*** guicontrol.c~	Sat Aug 23 07:30:51 1997
--- guicontrol.c	Thu Mar  5 21:31:06 1998
***************
*** 312,317 ****
--- 312,325 ----
        if (quit_flag)
  	{
  /* 	  fprintf(stderr, "quit_flag is true\n"); */
+ 
+ 	  if((flags = fcntl(STDOUT_FILENO, F_GETFL, 0)) < 0)
+ 	    perror("fcntl");
+ 	  flags &= ~O_NONBLOCK;
+   
+ 	  if(fcntl(STDOUT_FILENO, F_SETFL, flags) < 0)
+ 	    perror("fcntl");
+ 
  	  exit(0);
  	}
        while(GUI_FD_TO_PLAY != -1)
***************
*** 334,340 ****
  	 
  	 if((flags = fcntl(STDIN_FILENO, F_GETFL, 0)) < 0)
  	   perror("fcntl");
! 	 flags ^= O_NONBLOCK;
  	 
  	 if(fcntl(STDIN_FILENO, F_SETFL, flags) < 0)
  	   perror("fcntl");
--- 342,348 ----
  	 
  	 if((flags = fcntl(STDIN_FILENO, F_GETFL, 0)) < 0)
  	   perror("fcntl");
! 	 flags &= ~O_NONBLOCK;
  	 
  	 if(fcntl(STDIN_FILENO, F_SETFL, flags) < 0)
  	   perror("fcntl");
***************
*** 394,400 ****
                  /* Set stdin to blocking */
                  if((flags = fcntl(STDIN_FILENO, F_GETFL, 0)) < 0)
                          perror("fcntl");
!                 flags ^= O_NONBLOCK;
                  if(fcntl(STDIN_FILENO, F_SETFL, flags) < 0)
                          perror("fcntl");
          }
--- 402,408 ----
                  /* Set stdin to blocking */
                  if((flags = fcntl(STDIN_FILENO, F_GETFL, 0)) < 0)
                          perror("fcntl");
!                 flags &= ~O_NONBLOCK;
                  if(fcntl(STDIN_FILENO, F_SETFL, flags) < 0)
                          perror("fcntl");
          }
