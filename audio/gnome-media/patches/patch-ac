$NetBSD: patch-ac,v 1.2 2000/06/01 17:18:01 rh Exp $

--- gmix/gmix.c.orig	Sun May 21 22:12:50 2000
+++ gmix/gmix.c	Thu Jun  1 18:55:00 2000
@@ -56,7 +56,9 @@
 #ifdef ALSA
 #include <sys/asoundlib.h>
 #else
-#ifdef HAVE_LINUX_SOUNDCARD_H 
+#ifdef HAVE_SOUNDCARD_H
+#include <soundcard.h>
+#elif defined(HAVE_LINUX_SOUNDCARD_H)
 #include <linux/soundcard.h>
 #else 
 #include <machine/soundcard.h>
@@ -90,6 +92,13 @@
 GtkWidget *configwin;
 GtkWidget  *slidernotebook;
 
+#if !defined(HAVE_MIXER_INFO) && !defined(SOUND_MIXER_INFO)
+typedef struct {
+	char id[20];
+	char name[40];
+} mixer_info;
+#endif
+
 typedef struct {
 	gboolean set_mixer_on_start;
 	gboolean hide_menu;
@@ -697,12 +706,16 @@
 	/*
 	 * mixer-name
 	 */
+#ifdef HAVE_MIXER_INFO
 	res=ioctl(new_device->fd, SOUND_MIXER_INFO, &new_device->info);
 	if (res!=0) {
 		g_free(new_device);
 		return NULL;
 	}
 	if(!isalpha(new_device->info.name[0]))
+#else
+	g_snprintf(new_device->info.id, 31, "%d", num+1);
+#endif
 		g_snprintf(new_device->info.name, 31, "Card %d", num+1);
 	/* 
 	 * several bitmasks describing the mixer
