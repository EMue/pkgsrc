$NetBSD: patch-aa,v 1.2 2000/09/13 15:14:41 fredb Exp $

--- configure.in.orig	Mon Sep  6 14:31:59 1999
+++ configure.in	Wed Sep 13 09:40:58 2000
@@ -39,7 +39,7 @@
 	CRYPT_LIB="-lcrypt"
         AC_DEFINE(USE_LOCKF) 
 	;;
-	*freebsd*) IRRD_OPS_LIBS=""
+	*freebsd*|*netbsd*) IRRD_OPS_LIBS=""
 	CRYPT_LIB="-lcrypt"
         AC_DEFINE(USE_FLOCK)
 	;;
@@ -91,11 +91,12 @@
 fi
 AC_PATH_PROG(PGPV_PATH,pgpv,no)
 if test $PGPV_PATH = no; then
-    AC_PATH_PROG(PGPV_PATH,pgp,no)
-    if test $PGPV_PATH = no; then
+    AC_PATH_PROG(PGP_PATH,pgp,no)
+    if test $PGP_PATH = no; then
         PGPV_PATH=""
         AC_DEFINE(PGP,0)
     else
+	PGPV_PATH="$PGP_PATH"
         AC_DEFINE(PGP,26)
     fi
 else
@@ -178,18 +179,18 @@
   ifelse([$4], , , [else $4])
 fi])
 
-case "${host_os}" in
-    *bsdi* | *freebsd* | *netbsd* )
-dnl use kernel source if available
-        AC_DIR_EXIST(/sys/sys, [
-            CPPFLAGS="$CPPFLAGS -I/sys"
-            IN_H="$IN_H /sys/netinet/in.h"
-            IF_H="$IF_H /sys/net/if.h"])
-    ;;
-    * ) 
-dnl including header files under /sys makes SIOCGIFCONF confused on sunos.
-    ;;
-esac
+#case "${host_os}" in
+#    *bsdi* | *freebsd* | *netbsd* )
+#dnl use kernel source if available
+#        AC_DIR_EXIST(/sys/sys, [
+#            CPPFLAGS="$CPPFLAGS -I/sys"
+#            IN_H="$IN_H /sys/netinet/in.h"
+#            IF_H="$IF_H /sys/net/if.h"])
+#    ;;
+#    * ) 
+#dnl including header files under /sys makes SIOCGIFCONF confused on sunos.
+#    ;;
+#esac
 
 dnl Add the ICMP code;  we'll have to turn this into an interactive
 dnl question during the configure process later...
@@ -302,9 +303,10 @@
 AC_CHECK_HEADERS(gdbm.h, [exist_gdbm=yes],[exist_gdbm=no])
 fi
 
-AC_CHECK_LIB(db, dbopen, [exist_db1=yes],[exist_db1=no])
-if test $exist_db1 = yes; then
 AC_CHECK_HEADERS(db.h, [exist_db1=yes],[exist_db1=no])
+if test $exist_db1 = yes; then
+AC_CHECK_FUNC(dbopen,[db1_lib=no],
+    [AC_CHECK_LIB(db, dbopen, [DB_LIB="-ldb"],[exist_db1=no])])
 fi
 
 AC_MSG_CHECKING(for GDBM preference)
@@ -349,7 +351,6 @@
   if test "$db1_pref" = "DB1"; then
     if test $exist_db1 = yes; then
         AC_DEFINE(USE_DB1)
-        DB_LIB="-ldb"   
         db_check=done
         AC_MSG_RESULT(using DB1)
     fi
@@ -371,7 +372,6 @@
   if test "$db1_pref" != "NODB1"; then
     if test $exist_db1 = yes; then
       AC_DEFINE(USE_DB1)
-      DB_LIB="-ldb"
       db_check=done
     AC_MSG_RESULT(using DB1)
     fi
@@ -435,6 +435,13 @@
  	      AC_DEFINE(HAVE_LINUX_2_2_5_IPV6)
 	    ]
          )
+    ;;
+    *netbsd0|*netbsd1.[0123]*|*netbsd1.4|*netbsd1.4.*|*netbsd1.4[A-J] )
+            AC_MSG_RESULT(no)
+    ;;
+    *netbsd* )
+	    AC_DEFINE(HAVE_IPV6)
+            AC_MSG_RESULT(yes... NetBSD IPv6)
     ;;
     *solaris* )
 	AC_FILE_EXIST(/usr/ipv6/sbin/ifconfig, [
