$NetBSD: patch-di,v 1.1 1999/04/28 23:56:34 rvb Exp $

diff -u /usr/pkgsrc/net/coda-5.2.2/coda-src/venus/venusrecov.cc ./coda-src/venus/venusrecov.cc
--- /usr/pkgsrc/net/coda-5.2.2/coda-src/venus/venusrecov.cc	Mon Apr 19 20:03:05 1999
+++ ./coda-src/venus/venusrecov.cc	Wed Apr 28 13:01:27 1999
@@ -187,6 +192,13 @@
     fdprint(fd, "Ptrs = [%x %x %x %x %x %x], Heap = [%x] HeapLen = %x\n",
 	     recov_FSDB, recov_VDB, recov_VSGDB, recov_HDB, recov_LRDB, recov_VCBDB, 
 	     recov_HeapAddr, recov_HeapLength);
+
+    fdprint(fd, "UUID = %08x-%04x-%04x-%02x%02x-%02x%02x%02x%02x%02x%02x\n",
+	    ntohl(*(unsigned int *)&recov_UUID[0]),
+	    ntohs(*(unsigned short *)&recov_UUID[4]),
+	    ntohs(*(unsigned short *)&recov_UUID[6]),
+	    recov_UUID[8], recov_UUID[9], recov_UUID[10], recov_UUID[11],
+	    recov_UUID[12], recov_UUID[13], recov_UUID[14], recov_UUID[15]);
 }
 
 
@@ -201,6 +213,8 @@
 	rvg->recov_MagicNumber = RecovMagicNumber;
 	rvg->recov_VersionNumber = RecovVersionNumber;
 	rvg->recov_LastInit = Vtime();
+	VenusGenID = rpc2_NextRandom(NULL);
+
 	RecovInited = 1;
 	return;
     }
@@ -548,6 +562,8 @@
 		rvg->recov_HeapAddr = Recov_RdsAddr;
 		rvg->recov_HeapLength = (unsigned int)Recov_RdsLength;
 		
+		VenusGenID = rpc2_NextRandom(NULL);
+
 		/* Initialize the recoverable heap. */
 		int err = 0;
 		rds_init_heap(Recov_RdsAddr, Recov_RdsLength, (unsigned long)RdsChunkSize,
