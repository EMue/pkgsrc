$NetBSD: patch-ak,v 1.1 1999/09/29 00:41:26 christos Exp $
--- tcl/strerror.c.orig	Fri Feb 24 16:19:50 1995
+++ tcl/strerror.c	Tue Sep 28 18:36:37 1999
@@ -20,6 +20,7 @@
 #include <stdio.h>
 #include <string.h>
 
+#if !defined(BSD4_4) && !defined(__linux__)
 /*
  * List of known errors:
  */
@@ -138,3 +139,4 @@
     (void) sprintf(defaultMsg, "unknown error (%d)", error);
     return defaultMsg;
 }
+#endif
--- tcl/tclGlob.c.orig	Tue Sep 28 18:37:08 1999
+++ tcl/tclGlob.c	Tue Sep 28 18:39:13 1999
@@ -28,6 +28,12 @@
 #include <sys/stat.h>
 #include <tcl.h>
 
+#ifdef __linux__
+#define DIRNAMLEN(d) strlen((d)->d_name)
+#else
+#define DIRNAMLEN(d) ((d)->d_namlen)
+#endif
+
 /*
  * The structure below is used to keep track of a globbing result
  * being built up (i.e. a partial list of file names).  The list
@@ -298,12 +304,12 @@
 	    if (Tcl_StringMatch(entryPtr->d_name, pattern)) {
 		if (*p == 0) {
 		    AppendResult(dir, entryPtr->d_name,
-			    (int) entryPtr->d_namlen, resPtr);
+			    (int) DIRNAMLEN(entryPtr), resPtr);
 		} else {
-		    if ((l1+entryPtr->d_namlen+2) <= STATIC_SIZE) {
+		    if ((l1+DIRNAMLEN(entryPtr)+2) <= STATIC_SIZE) {
 			newDir = static1;
 		    } else {
-			newDir = malloc((unsigned) (l1+entryPtr->d_namlen+2));
+			newDir = malloc((unsigned) (l1+DIRNAMLEN(entryPtr)+2));
 		    }
 		    sprintf(newDir, "%s%s/", dir, entryPtr->d_name);
 		    result = DoGlob(interp, newDir, p+1, resPtr);
