$NetBSD: patch-aa,v 1.15 2001/05/22 21:49:29 jlam Exp $

--- configure.in.orig	Tue Apr 17 01:44:30 2001
+++ configure.in	Tue May 22 15:58:59 2001
@@ -392,9 +392,6 @@
 AC_CHECK_TYPE(ssize_t, int)
 AC_CHECK_TYPE(wchar_t, unsigned short)
 
-# we need libcups for CUPS support...
-AC_CHECK_LIB(cups,httpConnect)
-
 # we need libdl for PAM and the new VFS code
 AC_CHECK_LIB(dl, dlopen, [LIBS="$LIBS -ldl";
 	AC_DEFINE(HAVE_LIBDL)])
@@ -1460,6 +1457,24 @@
 fi
 
 
+################################################
+# check for CUPS support
+AC_MSG_CHECKING(whether to use CUPS)
+AC_ARG_WITH(cups,
+[  --with-cups    Include CUPS support
+  --without-cups Don't include CUPS support (default)],
+[ case "$withval" in
+  yes)
+    AC_MSG_RESULT(yes)
+    AC_CHECK_LIB(cups, httpConnect)
+    ;;
+  *)
+    AC_MSG_RESULT(no)
+    ;;
+  esac ],
+  AC_MSG_RESULT(no)
+)
+
 #################################################
 # check for smbwrapper support
 AC_MSG_CHECKING(whether to use smbwrapper)
@@ -1724,6 +1739,9 @@
 	  LIBS="-lssl -lcrypto $LIBS"
 	  LDFLAGS="=L/usr/local/ssl/lib $LDFLAGS"
 	;;
+	/usr)
+	  LIBS="-lssl -lcrypto $LIBS"
+	;;
         * )
           CFLAGS="-I${withval}/include $CFLAGS"
 	  LIBS="-lssl -lcrypto $LIBS"
@@ -1738,11 +1756,6 @@
 	LDFLAGS="-L/usr/local/ssl/lib $LDFLAGS"
 
     fi
-
-    if test ! -d ${withval}; then
-      echo "configure: error: called with --with-ssl, but ssl base directory ${withval} does not exist or is not a directory. Aborting config" 1>&2
-      exit 1
-    fi 
 
     CFLAGS="-DHAVE_CRYPT_DECL $CFLAGS"  # Damn, SSLeay defines its own
 
