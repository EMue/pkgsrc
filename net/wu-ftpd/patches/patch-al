$NetBSD: patch-al,v 1.3 1999/02/13 09:05:02 rh Exp $

--- src/realpath.c.orig	Mon Jul  6 11:14:39 1998
+++ src/realpath.c	Sat Feb 13 07:47:55 1999
@@ -143,7 +143,13 @@
             continue;
         if ((last == namebuf) || (*--last != '/'))
             strcat(namebuf, "/");
+	if (strlen(namebuf)+strlen(where) < sizeof(namebuf)) {
         strcat(namebuf, where);
+	} else {
+	    /* path too long: bail out */
+	    strcpy(result, "\0");
+	    return (NULL);
+	}
 
         where = ++ptr;
         if (lstat(namebuf, &sbuf) == -1) {
@@ -164,7 +170,13 @@
                 *workpath = '\0';
             if (*where) {
                 strcat(linkpath, "/");
+		if (strlen(linkpath) + strlen(where) < sizeof(linkpath)) {
                 strcat(linkpath, where);
+		} else {
+		    /* path too long: bail out */
+		    strcpy(result, "\0");
+		    return (NULL);
+		}
             }
             strcpy(curpath, linkpath);
             goto loop;
