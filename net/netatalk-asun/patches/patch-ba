$NetBSD: patch-ba,v 1.2 2000/08/15 14:48:24 abs Exp $

--- rc.atalk.bsd.orig	Mon Aug 25 23:00:54 1997
+++ rc.atalk.bsd
@@ -1,3 +1,4 @@
+#!/bin/sh
 #
 # AppleTalk daemons. Make sure not to start atalkd in the background:
 # its data structures must have time to stablize before running the
@@ -19,21 +20,17 @@
 fi
 
 if [ -x :BINDIR:/nbprgstr ]; then
-	:BINDIR:/nbprgstr -p 4 `hostname|sed 's/\..*$//'`:Workstation
-	:BINDIR:/nbprgstr -p 4 `hostname|sed 's/\..*$//'`:netatalk
+	:BINDIR:/nbprgstr -p 4 `hostname -s |sed 's/\..*$//'`:Workstation
+	:BINDIR:/nbprgstr -p 4 `hostname -s |sed 's/\..*$//'`:netatalk
 					echo -n ' nbprgstr'
 fi
 
-if [ -x :SBINDIR:/papd ]; then
+if [ -x :SBINDIR:/papd -a :ETCDIR:/papd.conf ]; then
 	:SBINDIR:/papd;		echo -n ' papd'
 fi
 
-if [ -x :SBINDIR:/afpd ]; then
+if [ -x :SBINDIR:/afpd -a :ETCDIR:/AppleVolumes.system ]; then
 	:SBINDIR:/afpd;		echo -n ' afpd'
-fi
-
-if [ -x :SBINDIR:/timelord ]; then
-	:SBINDIR:/timelord;		echo -n ' timelord'
 fi
 
 					echo '.'
