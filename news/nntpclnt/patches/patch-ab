$NetBSD: patch-ab,v 1.2 1998/08/07 11:11:13 agc Exp $

--- nntpclnt.c.orig	Thu Aug 11 23:37:51 1994
+++ nntpclnt.c	Fri May 22 10:20:49 1998
@@ -199,7 +199,7 @@
 server_init(machine)
 char    *machine;
 {
-	int     sockt_rd, sockt_wr;
+	int     sockt_rd, sockt_wr, result[2];
 	char    line[256];
 	char    *index();
 #if defined(DECNET) || defined(SGI4DDN)
@@ -248,7 +248,13 @@
 	/* Now get the server's signon message */
 
 	(void) get_server(line, sizeof(line));
-	return (atoi(line));
+	result[0] = atoi(line);
+
+	put_server("MODE READER");
+	(void) get_server(line, sizeof(line));
+	result[1] = atoi(line);
+
+	return ((result[1] != ERR_COMMAND) ? result[1] : result[0]);
 }
 
 #ifdef DATAKIT
