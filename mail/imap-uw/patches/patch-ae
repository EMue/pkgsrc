$NetBSD: patch-ae,v 1.11 2000/11/09 03:35:34 hubertf Exp $

--- src/osdep/unix/Makefile.orig	Wed Oct 25 01:59:24 2000
+++ src/osdep/unix/Makefile
@@ -87,7 +87,7 @@
 
 # Normally no need to change any of these
 
-ARCHIVE=c-client.a
+ARCHIVE=libimapuw.la
 BINARIES=mail.o misc.o newsrc.o smanager.o osdep.o utf8.o siglocal.o \
  dummy.o pseudo.o netmsg.o flstring.o fdstring.o \
  rfc822.o nntp.o smtp.o imap4r1.o pop3.o \
@@ -112,7 +112,7 @@
 # Here if no make argument established
 
 missing: osdep.h
-	$(MAKE) all CC=`$(CAT) CCTYPE` CFLAGS="`$(CAT) CFLAGS`" `$(CAT) SPECIALS`
+	$(MAKE) all CC="`$(CAT) CCTYPE`" CFLAGS="`$(CAT) CFLAGS`" `$(CAT) SPECIALS`
 
 osdep.h:
 	@echo You must specify what type of system
@@ -332,7 +332,7 @@
 	 RSHPATH=/usr/bin/rsh \
 	 BASECFLAGS="-g -O2" \
 	 BASELDFLAGS="-lsocket -lnsl -lgen" \
-	 RANLIB=true CC=gcc
+	 RANLIB=true CC="$(CC)"
 
 gsu:	# GCC SUN-OS
 	$(BUILD) `$(CAT) SPECIALS` OS=sun \
@@ -420,11 +420,12 @@
 
 neb:	# NetBSD
 	$(BUILD) `$(CAT) SPECIALS` OS=bsi \
+	 CC="$(CC)" \
 	 CRXTYPE=nfs \
 	 SPOOLDIR=/var \
-	 ACTIVEFILE=/var/db/news/active \
+	 ACTIVEFILE=/var/news/db/active \
 	 RSHPATH=/usr/bin/rsh \
-	 BASECFLAGS="-g -O -pipe" \
+	 BASECFLAGS="-O -pipe" \
 	 BASELDFLAGS="-lcrypt"
 
 nec:	# NEC UX
@@ -808,7 +809,7 @@
 	 -DACTIVEFILE=\"$(ACTIVEFILE)\" -DNEWSSPOOL=\"$(NEWSSPOOL)\" \
 	 -DRSHPATH=\"$(RSHPATH)\" -DLOCKPGM=\"$(LOCKPGM)\" > OSCFLAGS
 	echo $(BASELDFLAGS) $(EXTRALDFLAGS) > LDFLAGS
-	echo "$(ARRC) $(ARCHIVE) $(BINARIES);$(RANLIB) $(ARCHIVE)" > ARCHIVE
+	echo "$(CC) -o $(ARCHIVE) $(BINARIES:.o=.lo) -rpath $(PREFIX)/lib -version-info 4:1" > ARCHIVE
 	./drivers $(EXTRADRIVERS) $(DEFAULTDRIVERS) dummy
 	./mkauths $(EXTRAAUTHENTICATORS) $(DEFAULTAUTHENTICATORS)
 	$(LN) os_$(OS).h osdep.h
