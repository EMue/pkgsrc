$NetBSD: patch-ac,v 1.12 2001/03/03 12:27:51 frueauf Exp $

--- imap.c.orig	Thu Mar  1 20:26:58 2001
+++ imap.c	Sat Mar  3 12:57:24 2001
@@ -196,11 +196,9 @@
     strcat(msgbuf,"\r\n");
     SockWrite (sock, msgbuf, strlen (msgbuf));
   
-    if ((result = gen_recv (sock, msgbuf, sizeof msgbuf)))
+    result = imap_ok (sock, NULL);
+    if (result == PS_SUCCESS)
 	return result;
-  
-    if (strstr (msgbuf, "OK"))
-	return PS_SUCCESS;
     else
 	return PS_AUTHFAIL;
 }
