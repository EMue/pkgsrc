$NetBSD: patch-aa,v 1.2 2000/01/13 00:35:05 wiz Exp $

--- Makefile.Linux.orig	Wed Apr 21 20:16:24 1999
+++ Makefile.Linux	Thu Jan 13 01:05:47 2000
@@ -27,8 +27,6 @@
 RPMARCH=i386
 endif
 
-MAINDIR=/grog/Projects/QW
-
 BUILD_DEBUG_DIR=debug$(ARCH)$(GLIBC)
 BUILD_RELEASE_DIR=release$(ARCH)$(GLIBC)
 CLIENT_DIR=$(MAINDIR)/client
@@ -37,7 +35,8 @@
 MESA_DIR=/usr/local/src/Mesa-3.0
 
 CC=gcc
-BASE_CFLAGS=-Wall -Dstricmp=strcasecmp -I$(CLIENT_DIR) -I$(SERVER_DIR)
+BASE_CFLAGS=-Wall -Dstricmp=strcasecmp -I$(CLIENT_DIR) -I$(SERVER_DIR) \
+	${CFLAGS} -I${X11BASE}/include
 DEBUG_CFLAGS=$(BASE_CFLAGS) -g
 ifeq ($(ARCH),axp)
 RELEASE_CFLAGS=$(BASE_CFLAGS) -ffast-math -funroll-loops \
@@ -49,19 +48,21 @@
 endif
 GLCFLAGS=-DGLQUAKE -I/usr/local/src/Mesa-3.0/include -I/usr/include/glide
 
-LDFLAGS=-lm
+LDFLAGS=-lm -lossaudio
 SVGALDFLAGS=-lvga
 XLDFLAGS=-L/usr/X11R6/lib -lX11 -lXext
-GL_SVGA_LDFLAGS=-L/usr/X11/lib -L/usr/local/src/Mesa-3.0/lib -lm -lMesaGL -lglide2x -lX11 -lXext -lvga
-GL_X11_LDFLAGS=-L/usr/X11/lib -L/usr/local/src/Mesa-3.0/lib -lm -lGL -lX11 -lXext
+GL_SVGA_LDFLAGS=-L/usr/X11R6/lib -L/usr/local/src/Mesa-3.0/lib -lm -lMesaGL -lglide2x -lX11 -lXext -lvga
+GL_X11_LDFLAGS=-L/usr/X11R6/lib -L/usr/local/src/Mesa-3.0/lib -lm -lGL -lX11 -lXext
 
 DO_CC=$(CC) $(CFLAGS) -o $@ -c $<
 DO_O_CC=$(CC) -O $(CFLAGS) -o $@ -c $<
 DO_GL_CC=$(CC) $(CFLAGS) $(GLCFLAGS) -o $@ -c $<
 DO_SERVER_CC=$(CC) -DSERVERONLY $(CFLAGS) -o $@ -c $<
 
-DO_AS=$(CC) $(CFLAGS) -DELF -x assembler-with-cpp -o $@ -c $<
-DO_GL_AS=$(CC) $(CFLAGS) $(GLCFLAGS) -DELF -x assembler-with-cpp -o $@ -c $<
+DO_AS=$(CC) $(CFLAGS) -DAOUT -x assembler-with-cpp -o $@ -c $<
+#DO_AS=$(CC) $(CFLAGS) -DELF -x assembler-with-cpp -o $@ -c $<
+DO_GL_AS=$(CC) $(CFLAGS) $(GLCFLAGS) -DAOUT -x assembler-with-cpp -o $@ -c $<
+#DO_GL_AS=$(CC) $(CFLAGS) $(GLCFLAGS) -DELF -x assembler-with-cpp -o $@ -c $<
 
 #############################################################################
 # SETUP AND BUILD
@@ -71,7 +72,7 @@
 TARGETS=$(BUILDDIR)/qwsv 
 #$(BUILDDIR)/qwcl.x11
 else
-TARGETS=$(BUILDDIR)/qwsv $(BUILDDIR)/qwcl $(BUILDDIR)/qwcl.x11 $(BUILDDIR)/glqwcl $(BUILDDIR)/glqwcl.glx
+TARGETS=$(BUILDDIR)/qwsv $(BUILDDIR)/qwcl.x11 $(BUILDDIR)/glqwcl.glx
 endif
 
 build_debug:
@@ -269,7 +270,7 @@
 	$(BUILDDIR)/client/view.o \
 	$(BUILDDIR)/client/wad.o \
 	$(BUILDDIR)/client/zone.o \
-	$(BUILDDIR)/client/cd_linux.o \
+	$(BUILDDIR)/client/cd_null.o \
 	$(BUILDDIR)/client/sys_linux.o \
 	$(BUILDDIR)/client/snd_linux.o \
 
@@ -485,7 +486,7 @@
 $(BUILDDIR)/client/zone.o :           $(CLIENT_DIR)/zone.c
 	$(DO_CC)
                                                                       
-$(BUILDDIR)/client/cd_linux.o :       $(CLIENT_DIR)/cd_linux.c
+$(BUILDDIR)/client/cd_null.o :        $(CLIENT_DIR)/cd_null.c
 	$(DO_CC)
                                                                       
 $(BUILDDIR)/client/sys_linux.o :      $(CLIENT_DIR)/sys_linux.c
@@ -590,7 +591,7 @@
 	$(BUILDDIR)/glclient/view.o \
 	$(BUILDDIR)/glclient/wad.o \
 	$(BUILDDIR)/glclient/zone.o \
-	$(BUILDDIR)/glclient/cd_linux.o \
+	$(BUILDDIR)/glclient/cd_null.o \
 	$(BUILDDIR)/glclient/sys_linux.o \
 	$(BUILDDIR)/glclient/snd_linux.o \
 	\
@@ -715,7 +716,7 @@
 $(BUILDDIR)/glclient/zone.o :          $(CLIENT_DIR)/zone.c
 	$(DO_GL_CC)
 
-$(BUILDDIR)/glclient/cd_linux.o :      $(CLIENT_DIR)/cd_linux.c
+$(BUILDDIR)/glclient/cd_null.o :       $(CLIENT_DIR)/cd_null.c
 	$(DO_GL_CC)
 
 $(BUILDDIR)/glclient/sys_linux.o :     $(CLIENT_DIR)/sys_linux.c
