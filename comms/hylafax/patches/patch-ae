$NetBSD: patch-ae,v 1.5 2001/07/08 13:32:15 bad Exp $

--- configure.orig	Thu May 31 04:29:46 2001
+++ configure	Sun Jul  8 02:41:07 2001
@@ -37,22 +37,22 @@
 #
 # Setup general configuration parameters.
 #
-DIR_BIN=/usr/local/bin
-DIR_SBIN=/usr/local/sbin
-DIR_LIBDATA=/usr/local/lib/fax
-DIR_LIBEXEC=$DIR_SBIN
+DIR_BIN=${PREFIX}/bin
+DIR_SBIN=${PREFIX}/sbin
+DIR_LIBDATA=${PREFIX}/libdata/hylafax
+DIR_LIBEXEC=${PREFIX}/libexec
 DIR_SPOOL=/var/spool/hylafax
-DIR_HTML=/var/httpd/htdocs/hylafax
-DIR_CGI=/var/httpd/cgi-bin
+DIR_HTML=${RPEFIX}/http/htdocs/hylafax
+DIR_CGI=${RPEFIX}/http/cgi-bin
 PATH_DPSRIP=$DIR_LIBEXEC/ps2fax.exe
-PATH_IMPRIP=/usr/lib/print/psrip
+PATH_IMPRIP=${PREFIX}/lib/print/psrip
 HTMLPATH=/hylafax
 CGIPATH=/cgi-bin
 DEFVRES=98
 PAGESIZE="North American Letter"
 FAXUID=uucp
 FAXGID=
-SYSUID=bin
+SYSUID=root
 SYSGID=
 DSO=auto
 GETTY=auto
@@ -71,8 +71,8 @@
 GS=no
 IMP=no
 UTMP=auto
-LIBTIFF="-L/usr/local/lib -ltiff"
-TIFFINC=/usr/local/include
+LIBTIFF="-Wl,-R${PREFIX}/lib -L${PREFIX}/lib -ltiff -ljpeg -lz -lm"
+TIFFINC=${PREFIX}/include
 TIFFBIN=
 LIBZ=
 ZLIBINC=
@@ -80,8 +80,8 @@
 LIBREGEX='-L${DEPTH}/regex -lregex'
 REGEXINC='${DEPTH}/${TOPSRCDIR}/regex'
 DBLIB=no
-LIBDB="-L/usr/local/lib -ldb"
-DBLIBINC=/usr/local/include
+LIBDB="-L${PREFIX}/lib -ldb"
+DBLIBINC=${PREFIX}/include
 CONFIG_OSFCNH=auto
 MANNUM4_5=4F
 MANNUM1_8=1M
@@ -208,6 +208,7 @@
 PKG_VENDOR
 PORT
 PORTFUNCS
+PREFIX
 PROTOTYPES
 PSPACKAGE	PS
 PWD
@@ -271,7 +272,7 @@
 test -d /usr/ucb && PATH=$PATH:/usr/ucb			# Sun and others
 test -d /usr/contrib/bin && PATH=$PATH:/usr/contrib/bin	# BSDi
 test -d /usr/5bin && PATH=/usr/5bin:$PATH:/usr/etc	# Sun and others
-test -d /usr/local/bin && PATH=/usr/local/bin:$PATH	# for GNU stuff
+test -d ${PREFIX}/bin && PATH=${PREFIX}/bin:$PATH	# for packages stuff
 PATH=$PATH:$OPATH
 
 POSIXLY_CORRECT=1; export POSIXLY_CORRECT		# disable GNU extensions
@@ -652,6 +653,7 @@
 {
     echo `(for i do
 	case "$i" in
+	-Wl*)			echo "$i" ;;
 	/*|-l*|-l[$]{DEPTH}/*)	echo "$i" ;;
 	-L|-L/*|-L[$]{DEPTH}/*)	echo "$i" ;;
 	-I|-I/*|-I[$]{DEPTH}/*)	echo "$i" ;;
@@ -3004,7 +3006,7 @@
 # Location of TIFF binaries
 #
 if [ -z "$TIFFBIN" ]; then
-    DIRS="/usr/local/bin /usr/contrib/bin /usr/gnu/bin /usr/bin"
+    DIRS="${PREFIX}/bin /usr/local/bin /usr/gnu/bin /usr/bin"
     for i in $DIRS; do
         test -x $i/tiff2ps && { TIFFBIN=$i; break; }
     done
@@ -3036,13 +3038,7 @@
         printf("old include files: version %u\n", ZLIB_VERSION);
         exit(-1);
     }
-    if (strncmp(zlib_version, ZLIB_VERSION, 4) != 0) {
-        printf("library/header file incompatibility: %s %s\n",
-        zlib_version, ZLIB_VERSION);
-        exit(-1);
-    } else {
         exit(0);
-    }
 }
 EOF
 capture cat t.c
@@ -3517,6 +3513,7 @@
 if [ -z "$SYSGID" ]; then
     case $TARGET in
     *-aix*)	SYSGID=sys;;
+    *netbsd*)	SYSGID=wheel;;
     *bsd*)	SYSGID=bin;;
     *-hpux*)	SYSGID=bin;;
     *-irix*)	SYSGID=sys;;
@@ -3603,7 +3600,7 @@
 if [ -z "$PATH_VGETTY" ]; then
     PATH_VGETTY=`findApp vgetty /usr/libexec:/sbin:$PATH` 
     if [ -z "$PATH_VGETTY" ]; then
-	PATH_VGETTY=/bin/vgetty
+	PATH_VGETTY=${PREFIX}/bin/vgetty
 	Note "WARNING, no vgetty program found to handle a voice call, using $PATH_VGETTY."
     else
 	Note "Looks like $PATH_VGETTY is the program to exec for a voice call."
@@ -3616,7 +3613,7 @@
 if [ -z "$PATH_EGETTY" ]; then
     PATH_EGETTY=`findApp egetty /usr/libexec:/sbin:$PATH` 
     if [ -z "$PATH_EGETTY" ]; then
-	PATH_EGETTY=/bin/egetty
+	PATH_EGETTY=${PREFIX}/bin/egetty
 	Note "WARNING, no egetty program found, using $PATH_EGETTY."
     else
 	Note "Looks like $PATH_EGETTY is the program to exec for an extern call."
@@ -3687,6 +3684,7 @@
 {
     if [ -z "$PATH_GSRIP" ]; then
 	GSLOCS="
+	    ${PREFIX}/bin/gs
 	    /usr/local/bin/gs
 	    /usr/contrib/bin/gs
 	    /usr/gnu/bin/gs
@@ -3734,7 +3732,7 @@
 on building Ghostscript with the necessary TIFF driver.
 
 EOF
-	PATH_PSRIP=/usr/local/bin/gs
+	PATH_PSRIP=${PREFIX}/bin/gs
 	PATH_GSRIP=$PATH_PSRIP
     fi
 }
@@ -3801,9 +3799,9 @@
     else
         DIR_AFMS="
 	    /usr/lib/afm
-	    /usr/local/lib/afm
-	    /usr/local/share/ghostscript/fonts
-	    /usr/local/lib/ghostscript/fonts
+	    ${PREFIX}/lib/afm
+	    ${PREFIX}/share/ghostscript/fonts
+	    ${PREFIX}/lib/ghostscript/fonts
 	    /usr/share/ghostscript/fonts
 	    /usr/gnu/lib/ghostscript/fonts
 	    /opt/gnu/lib/ghostscript/fonts
@@ -3823,7 +3821,7 @@
 fi
 if [ -z "$PATH_AFM" ]; then
     # put it where ghostscript normally puts things
-    PATH_AFM=/usr/local/lib/ghostscript/fonts
+    PATH_AFM=${PREFIX}/share/ghostscript/fonts
     Note "WARNING, could not locate a directory with font metric information,"
     Note "guessing that font metric information goes in $PATH_AFM."
 else
@@ -3842,6 +3840,7 @@
 #
 if [ -z "$DIR_MAN" ]; then
     MANPATH="
+	${PREFIX}/man
 	$MANPATH
 	/usr/local/man
 	/usr/contrib/man
@@ -3851,7 +3850,7 @@
     for i in $MANPATH; do
 	test -d $i && { DIR_MAN=$i; break; }
     done
-    test -z "$DIR_MAN" && DIR_MAN=/usr/local/man
+    test -z "$DIR_MAN" && DIR_MAN=${PREFIX}/man
 fi
 Note "Looks like manual pages go in $DIR_MAN."
 if [ -z "$MANSCHEME" ]; then
