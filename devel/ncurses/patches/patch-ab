$NetBSD: patch-ab,v 1.6 1999/09/13 21:20:34 fredb Exp $

--- configure.orig	Thu Feb 12 17:46:01 1998
+++ configure	Mon Sep 13 15:33:07 1999
@@ -1628,6 +1628,7 @@
     test -z "$cf_dir" && cf_dir=/usr/man
     cf_rename=""
     cf_format=no
+    if false ; then	# install unformatted man pages
     for cf_name in $cf_dir/*/date.[01]* $cf_dir/*/date
     do
        cf_test=`echo $cf_name | sed -e 's/*//'`
@@ -1641,6 +1642,8 @@
 	  break
        fi
     done
+    else cf_form=cat
+    fi
     if test "$cf_form" != "unknown" ; then
        break
     fi
@@ -2103,7 +2106,7 @@
 
 	
 	case $DFT_LWR_MODEL in
-	normal)  DFT_DEP_SUFFIX='.a'   ;;
+	normal)  DFT_DEP_SUFFIX='.la'  ;;
 	debug)   DFT_DEP_SUFFIX='_g.a' ;;
 	profile) DFT_DEP_SUFFIX='_p.a' ;;
 	shared)
@@ -4842,36 +4845,37 @@
 cross_compiling=$ac_cv_prog_cxx_cross
 
 	
-cf_cxx_library=unknown
-if test $ac_cv_prog_gxx = yes; then
-	echo $ac_n "checking for libg++""... $ac_c" 1>&6
-echo "configure:4849: checking for libg++" >&5
-	cf_save="$LIBS"
-	LIBS="$LIBS -lg++ -lm"
-	cat > conftest.$ac_ext <<EOF
-#line 4853 "configure"
-#include "confdefs.h"
-
-#include <builtin.h>
-	
-int main() {
-float foo=abs(1.0)
-; return 0; }
-EOF
-if { (eval echo configure:4862: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest; then
-  rm -rf conftest*
-  cf_cxx_library=yes
-	 CXXLIBS="$CXXLIBS -lg++ -lm"
-else
-  echo "configure: failed program was:" >&5
-  cat conftest.$ac_ext >&5
-  rm -rf conftest*
-  cf_cxx_library=no
-fi
-rm -f conftest*
-	LIBS="$cf_save"
+cf_cxx_library=no
+#cf_cxx_library=unknown
+#if test $ac_cv_prog_gxx = yes; then
+#	echo $ac_n "checking for libg++""... $ac_c" 1>&6
+#echo "configure:4849: checking for libg++" >&5
+#	cf_save="$LIBS"
+#	LIBS="$LIBS -lg++ -lm"
+#	cat > conftest.$ac_ext <<EOF
+##line 4853 "configure"
+##include "confdefs.h"
+#
+##include <builtin.h>
+#	
+#int main() {
+#float foo=abs(1.0)
+#; return 0; }
+#EOF
+#if { (eval echo configure:4862: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest; then
+#  rm -rf conftest*
+#  cf_cxx_library=yes
+#	 CXXLIBS="$CXXLIBS -lg++ -lm"
+#else
+#  echo "configure: failed program was:" >&5
+#  cat conftest.$ac_ext >&5
+#  rm -rf conftest*
+#  cf_cxx_library=no
+#fi
+#rm -f conftest*
+#	LIBS="$cf_save"
 	echo "$ac_t""$cf_cxx_library" 1>&6
-fi
+#fi
 
 	echo $ac_n "checking how to run the C++ preprocessor""... $ac_c" 1>&6
 echo "configure:4878: checking how to run the C++ preprocessor" >&5
@@ -5310,7 +5314,7 @@
 
 # dependencies and linker-arguments for test-programs
 TEST_DEPS="${LIB_PREFIX}${LIB_NAME}${DFT_DEP_SUFFIX} $TEST_DEPS"
-TEST_ARGS="-l${LIB_NAME}${DFT_ARG_SUFFIX} $TEST_ARGS"
+TEST_ARGS="${LIB_PREFIX}${LIB_NAME}${DFT_DEP_SUFFIX} $TEST_ARGS"
 
 # dependencies and linker-arguments for utility-programs
 PROG_ARGS="$TEST_ARGS"
@@ -5353,16 +5357,13 @@
 EOF
 
 			TEST_DEPS="${LIB_PREFIX}${cf_dir}${DFT_DEP_SUFFIX} $TEST_DEPS"
-			TEST_ARGS="-l${cf_dir}${DFT_ARG_SUFFIX} $TEST_ARGS"
+			TEST_ARGS="${LIB_PREFIX}${cf_dir}${DFT_DEP_SUFFIX} $TEST_ARGS"
 		fi
 	fi
 done
 echo "$ac_t""$cf_cv_src_modules" 1>&6
-TEST_ARGS="-L${LIB_DIR} -L\$(libdir) $TEST_ARGS"
-
-
+TEST_ARGS="-L\$(libdir) $TEST_ARGS"
 
-PROG_ARGS="-L${LIB_DIR} -L\$(libdir) $PROG_ARGS"
 
 
 SRC_SUBDIRS="man include"
@@ -5888,7 +5889,7 @@
 			
 	
 	case $cf_item in
-	normal)  cf_suffix='.a'   ;;
+	normal)  cf_suffix='.la'  ;;
 	debug)   cf_suffix='_g.a' ;;
 	profile) cf_suffix='_p.a' ;;
 	shared)
@@ -5931,7 +5932,7 @@
 			
 	
 	case $cf_item in
-	normal)  cf_suffix='.a'   ;;
+	normal)  cf_suffix='.la'  ;;
 	debug)   cf_suffix='_g.a' ;;
 	profile) cf_suffix='_p.a' ;;
 	shared)
@@ -6120,7 +6121,7 @@
 		for i in `cat $srcdir/$cf_dir/headers |fgrep -v "#"`
 		do
 			echo "	@ (cd \$(INSTALL_PREFIX)\$(includedir) && rm -f `basename $i`) ; ../headers.sh \$(INSTALL_DATA) \$(INSTALL_PREFIX)\$(includedir) \$(srcdir) $i" >>$cf_dir/Makefile
-			test $i = curses.h && echo "	@ (cd \$(INSTALL_PREFIX)\$(includedir) && rm -f ncurses.h && \$(LN_S) curses.h ncurses.h)" >>$cf_dir/Makefile
+			test $i = curses.h && echo "	@ (cd \$(INSTALL_PREFIX)\$(includedir) && rm -f ncurses.h && mv -f curses.h ncurses.h)" >>$cf_dir/Makefile
 		done
 
 	cat >>$cf_dir/Makefile <<CF_EOF
