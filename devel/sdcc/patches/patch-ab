$NetBSD: patch-ab,v 1.2 2000/08/25 21:49:29 tron Exp $

--- asxxxx/i51mch.c.orig	Mon Sep 13 14:48:29 1999
+++ asxxxx/i51mch.c	Fri Aug 25 23:17:56 2000
@@ -390,8 +390,8 @@
 			v1 = -3;
 		    else
 			v1 = e1.e_addr - dot.s_addr - 1;
-			/* if ((v1 < -128) || (v1 > 127))
-				aerr(); */
+			if (((v1 < -128) || (v1 > 127)) && pass > 0)
+				aerr();
 			outab(v1);
 		} else {
 			outrb(&e1, R_PCR);
@@ -409,8 +409,8 @@
 			v1 = -2;
 		    else   
 			v1 = e1.e_addr - dot.s_addr - 1;
-			/* if ((v1 < -128) || (v1 > 127))
-				aerr();*/
+			if (((v1 < -128) || (v1 > 127)) && pass > 0)
+				aerr();
 			outab(v1);
 		} else {
 			outrb(&e1, R_PCR);
@@ -464,8 +464,8 @@
 			v1 = -3;
 		    else   
 			v1 = e1.e_addr - dot.s_addr - 1;
-			/* if ((v1 < -128) || (v1 > 127))
-				aerr(); */
+			if (((v1 < -128) || (v1 > 127)) && pass > 0)
+				aerr();
 			outab(v1);
 		} else {
 			outrb(&e1, R_PCR);
@@ -501,8 +501,8 @@
 			v1 = -2;
 		    else   
 			v1 = e1.e_addr - dot.s_addr - 1;
-			/* if ((v1 < -128) || (v1 > 127))
-				aerr(); */
+			if (((v1 < -128) || (v1 > 127)) && pass > 0)
+				aerr();
 			outab(v1);
 		} else {
 			outrb(&e1, R_PCR);
