$NetBSD: patch-ap,v 1.1 1999/04/20 15:01:11 mycroft Exp $

--- src/main.c.orig	Wed Aug 12 18:39:33 1998
+++ src/main.c	Tue Apr 20 10:20:12 1999
@@ -40,6 +40,7 @@
 int quiet = 0;
 int trace = 0;
 int noexec = 0;
+int nolock = 0;
 int logoff = 0;
 
 /* Set if we should be writing CVSADM directories at top level.  At
@@ -217,6 +218,7 @@
     "    -w           Make checked-out files read-write (default).\n",
     "    -l           Turn history logging off.\n",
     "    -n           Do not execute anything that will change the disk.\n",
+    "    -u           Don't create locks (implies -l).\n",
     "    -t           Show trace of program execution -- try with -n.\n",
     "    -v           CVS version and copyright.\n",
     "    -b bindir    Find RCS programs in 'bindir'.\n",
@@ -485,7 +487,7 @@
     opterr = 1;
 
     while ((c = getopt_long
-            (argc, argv, "+Qqrwtnlvb:T:e:d:Hfz:s:xa", long_options, &option_index))
+            (argc, argv, "+Qqrwtnulvb:T:e:d:Hfz:s:xa", long_options, &option_index))
            != EOF)
     {
 	switch (c)
@@ -523,6 +525,8 @@
 		break;
 	    case 'n':
 		noexec = 1;
+	    case 'u':			/* Fall through */
+		nolock = 1;
 	    case 'l':			/* Fall through */
 		logoff = 1;
 		break;
@@ -802,7 +806,7 @@
 	     * BUT, only if the history file exists.
 	     */
 
-	    if (!client_active)
+	    if (!client_active && !nolock)
 	    {
 		char *path;
 		int save_errno;
