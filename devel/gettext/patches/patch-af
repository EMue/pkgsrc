$NetBSD: patch-af,v 1.1 2000/06/30 17:07:36 danw Exp $

Fixes from glibc

--- intl/finddomain.c.orig	Fri Jun 23 03:23:00 2000
+++ intl/finddomain.c	Fri Jun 23 04:18:34 2000
@@ -81,7 +81,7 @@
   const char *modifier;
   const char *territory;
   const char *codeset;
-  const char *normalized_codeset;
+  char *normalized_codeset;
   const char *special;
   const char *sponsor;
   const char *revision;
@@ -192,6 +192,10 @@
   if (alias_value != NULL)
     free (locale);
 
+  /* The space for normalized_codeset is dynamically allocated.  Free it.  */
+  if (mask & XPG_NORM_CODESET)
+    free (normalized_codeset);
+
   return retval;
 }
 
@@ -208,6 +212,7 @@
       if (runp->data != NULL)
 	_nl_unload_domain ((struct loaded_domain *) runp->data);
       runp = runp->next;
+      free (here->filename);
       free (here);
     }
 }
