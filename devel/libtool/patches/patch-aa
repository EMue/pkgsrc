$NetBSD: patch-aa,v 1.6 1998/11/12 16:27:31 agc Exp $

--- ltconfig.orig	Fri Mar 20 03:00:29 1998
+++ ltconfig	Sun Sep 27 11:47:30 1998
@@ -808,7 +808,11 @@
 
   netbsd*)
     # Tested with NetBSD 1.2 ld
-    archive_cmds='$LD -Bshareable -o $lib$libobjs'
+    if $CC -E - -dM </dev/null | grep -q __ELF__; then
+      archive_cmds='$LD -shared -o $lib$libobjs'	# ELF
+    else
+      archive_cmds='$LD -Bshareable -o $lib$libobjs'	# a.out
+    fi
     hardcode_libdir_flag_spec='-R$libdir'
     hardcode_direct=yes
     hardcode_shlibpath_var=no
@@ -1181,8 +1185,15 @@
 
 netbsd* | openbsd*)
   version_type=sunos
-  library_names_spec='${libname}${release}.so.$versuffix'
-  finish_cmds='PATH="$PATH:/sbin" ldconfig -m $libdir'
+  if $CC -E - -dM </dev/null | grep -q __ELF__; then
+    library_names_spec='${libname}${release}.so.$versuffix ${libname}${release}.so.$major ${libname}${release}.so'
+    soname_spec='${libname}${release}.so.$major'
+    dynamic_linker='NetBSD ld.elf_so'
+  else
+    library_names_spec='${libname}${release}.so.$versuffix'
+    finish_cmds='PATH="$PATH:/sbin" ldconfig -m $libdir'
+    dynamic_linker='NetBSD/OpenBSD (a.out) ld.so'
+  fi
   shlibpath_var=LD_LIBRARY_PATH
   ;;
 
