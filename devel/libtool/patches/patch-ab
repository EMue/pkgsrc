$NetBSD: patch-ab,v 1.10 2000/06/04 17:56:17 rh Exp $

--- ltmain.in.orig	Sat May 27 03:53:15 2000
+++ ltmain.in	Sun Jun  4 19:33:08 2000
@@ -819,6 +819,7 @@
     old_convenience=
     deplibs=
     linkopts=
+    wllinkopts=
 
     if test -n "$shlibpath_var"; then
       # get the directories listed in $shlibpath_var
@@ -1154,6 +1155,25 @@
 	continue
 	;;
 
+      -Wl,*)
+       args=`$echo "X$arg" | $Xsed -e "$sed_quote_subst" -e 's/^-Wl,//'`
+       arg=
+       IFS="${IFS=     }"; save_ifs="$IFS"; IFS=','
+       for flag in $args; do
+         IFS="$save_ifs"
+         case "$flag" in
+           *[\[\~\#\^\&\*\(\)\{\}\|\;\<\>\?\'\ \	]*|*]*|"")
+           flag="\"$flag\""
+           ;;
+         esac
+         arg="$arg $wl$flag"
+         linkopts="$linkopts $flag"
+         wllinkopts="$wllinkopts $wl$flag"
+       done
+       IFS="$save_ifs"
+       arg=`$echo "X$arg" | $Xsed -e "s/^ //"`
+       ;;
+
       # Some other compiler flag.
       -* | +*)
 	# Unknown arguments in both finalize_command and compile_command need
@@ -2146,6 +2166,7 @@
 	if test "$thread_safe" = yes && test -n "$thread_safe_flag_spec"; then
 	  eval flag=\"$thread_safe_flag_spec\"
 	  linkopts="$linkopts $flag"
+          wllinkopts="$wllinkopts $wl$flag"
 	fi
 
 	# Do each of the archive commands.
