$NetBSD: patch-aa,v 1.5 2001/02/28 12:29:30 wiz Exp $

--- doinstall.tcl.orig	Fri Sep 29 06:44:53 2000
+++ doinstall.tcl
@@ -2,5 +2,5 @@
 #-*-tcl-*-
 # the next line restarts using wish \
-exec wish "$0" -- ${1+"$@"}
+exec tclsh "$0" "$@"
 
 #
@@ -19,23 +19,6 @@
   } else {
     set BINDIR [file join $INSTALLROOT bin]
-    set LIBDIR [file join $INSTALLROOT lib]
-    set MANDIR [file join $INSTALLROOT man mann]
-  }
-
-  set msg(1) [file join $BINDIR $TKCVS]
-  set msg(2) [file join $BINDIR $TKDIFF]
-  set msg(3) [file join $LIBDIR tkcvs *.tcl]
-  set msg(4) [file join $LIBDIR tkcvs bitmaps *.gif]
-  if {$tcl_platform(platform) == "unix"} {
-     set msg(5) [file join $MANDIR tkcvs.n]
-  }
-  foreach m [lsort [array names msg]] {
-    if {[winfo exists .messages.$m]} {
-      destroy .messages.$m
-    }
-    global var$m
-    set var$m $msg($m)
-    label .messages.$m -text $msg($m) -justify left -textvariable var$m
-    pack .messages.$m -side top -anchor w
+    set LIBDIR [file join $INSTALLROOT share]
+    set MANDIR [file join $INSTALLROOT man man1]
   }
 }
@@ -76,6 +59,6 @@
     file attributes [file join $BINDIR $TKDIFF] -permissions 0755
     file mkdir $MANDIR
-    puts "Installing manpage tkcvs.n in $MANDIR"
-    file copy -force [file join tkcvs tkcvs.n] $MANDIR
+    puts "Installing manpage tkcvs.1 in $MANDIR"
+    file copy -force [file join tkcvs tkcvs.1] $MANDIR
   }
 
@@ -95,9 +78,4 @@
   cd ..
   puts "Finished!"
-
-  destroy .bottom.do
-  destroy .bottom.not
-  button .bottom.done -text "Finished!" -command {destroy .}
-  pack .bottom.done
 }
 
@@ -105,10 +83,5 @@
 
 # Check Tcl/TK version
-if {$tk_version < 8.1} {
-   tk_dialog .wrongversion "Tcl/Tk too old" \
-   "TkCVS requires Tcl/Tk 8.1 or better!" \
-   error 0 {Bye Bye}
-   exit 1
-}
+# This is done by the package Makefile
 
 # Some rational and reasonable defaults.
@@ -128,27 +101,5 @@
   set INSTALLROOT [lindex $argv 0]
 }
-frame .title
-label .title.lbl -text "TkCVS Installer" -font {Helvetica -14 bold}
-pack .title -side top
-pack .title.lbl -side top
-frame .entry
-label .entry.instlbl -text "Installation Root"
-entry .entry.instent -textvariable INSTALLROOT
-bind .entry.instent <Return> {show_paths $INSTALLROOT}
-pack .entry -side top -pady 10
-pack .entry.instlbl -side left
-pack .entry.instent -side left
-
-frame .messages -relief groove -bd 2
-pack .messages -side top -expand y -fill x
-label .messages.adv -text "These files will be installed:"
-pack .messages.adv -side top
-show_paths $INSTALLROOT
-
-frame .bottom
-button .bottom.do -text "Install" -command {doinstall $INSTALLROOT}
-button .bottom.not -text "Cancel" -command {destroy .}
-pack .bottom -side top
-pack .bottom.do -side left
-pack .bottom.not -side left
 
+show_paths $INSTALLROOT
+doinstall $INSTALLROOT
