$NetBSD: patch-aj,v 1.2 2000/10/15 07:39:45 wulf Exp $

--- configure.in.orig	Wed Sep 27 15:45:33 2000
+++ configure.in	Mon Oct  2 13:23:58 2000
@@ -939,6 +939,51 @@
         # NetBSD does not define "unix"
         CFLAGS="$CFLAGS -Dunix"
         ;;
+    *-*-netbsd*)
+        ARCH=netbsd
+        CheckESD
+        CheckX11
+        CheckAAlib
+        CheckOpenGL
+        CheckPTHREAD
+        # Set up files for the main() stub
+        COPY_ARCH_SRC(src/main, linux, SDL_main.c)
+        # Set up files for the audio library
+        AUDIO_ARCH=netbsd
+        AUDIO_ARCH_LIB=$AUDIO_ARCH/libaudio_arch.la
+        if test x$enable_audio = xyes; then
+            COPY_ARCH_SRC(src/audio, solaris, SDL_audiodev_c.h)
+            COPY_ARCH_SRC(src/audio, linux, SDL_audiodev.c)
+            COPY_ARCH_SRC(src/audio, linux, SDL_esdaudio.h)
+            COPY_ARCH_SRC(src/audio, linux, SDL_esdaudio.c)
+            COPY_ARCH_SRC(src/audio, solaris, SDL_lowaudio.h)
+            COPY_ARCH_SRC(src/audio, solaris, SDL_sysaudio.c)
+        fi
+        # Set up files for the joystick library
+	# (No joystick support yet)
+        if test x$enable_joystick = xyes; then
+            COPY_ARCH_SRC(src/joystick, dummy, SDL_sysjoystick.c)
+        fi
+        # Set up files for the cdrom library
+        if test x$enable_cdrom = xyes; then
+            COPY_ARCH_SRC(src/cdrom, freebsd, SDL_syscdrom.c)
+        fi
+        # Set up files for the thread library
+        if test x$enable_threads = xyes; then
+            COPY_ARCH_SRC(src/thread, linux, SDL_systhread.c)
+            COPY_ARCH_SRC(src/thread, linux, SDL_systhread_c.h)
+            COPY_ARCH_SRC(src/thread, linux, SDL_sysmutex.c)
+            COPY_ARCH_SRC(src/thread, linux, SDL_sysmutex_c.h)
+            COPY_ARCH_SRC(src/thread, generic, SDL_syssem.c)
+            COPY_ARCH_SRC(src/thread, generic, SDL_syssem_c.h)
+            COPY_ARCH_SRC(src/thread, linux, SDL_syscond.c)
+            COPY_ARCH_SRC(src/thread, generic, SDL_syscond_c.h)
+        fi
+        # Set up files for the timer library
+        if test x$enable_timers = xyes; then
+            COPY_ARCH_SRC(src/timer, linux, SDL_systimer.c)
+        fi
+        ;;
     *-*-openbsd*)
         ARCH=openbsd
         CheckESD
@@ -1325,6 +1370,7 @@
 AM_CONDITIONAL(TARGET_SOLARIS, test $ARCH = solaris)
 AM_CONDITIONAL(TARGET_IRIX, test $ARCH = irix)
 AM_CONDITIONAL(TARGET_FREEBSD, test $ARCH = freebsd)
+AM_CONDITIONAL(TARGET_NETBSD, test $ARCH = netbsd)
 AM_CONDITIONAL(TARGET_OPENBSD, test $ARCH = openbsd)
 AM_CONDITIONAL(TARGET_AIX, test $ARCH = aix)
 AM_CONDITIONAL(TARGET_WIN32, test $ARCH = win32)
@@ -1341,6 +1387,10 @@
   SDL_RLD_FLAGS="-R\${exec_prefix}/lib"
 fi

+if test $ARCH = netbsd; then
+  SDL_RLD_FLAGS="-Wl,-R\${exec_prefix}/lib -Wl,-R\${X11BASE}/lib"
+fi
+
 dnl Output the video drivers we use
 if test x$enable_video = xtrue; then
     if test "$VIDEO_SUBDIRS" = ""; then
@@ -1395,6 +1445,7 @@
 src/audio/irix/Makefile
 src/audio/linux/Makefile
 src/audio/macos/Makefile
+src/audio/netbsd/Makefile
 src/audio/openbsd/Makefile
 src/audio/solaris/Makefile
 src/audio/win32/Makefile
