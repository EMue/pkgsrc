$NetBSD: patch-ag,v 1.1 1998/12/03 17:23:53 tv Exp $

--- src/Configure.orig	Wed Oct  7 05:19:30 1998
+++ src/Configure	Wed Dec  2 11:49:22 1998
@@ -913,16 +914,15 @@
             LDFLAGS_SHLIB_EXPORT=""
             SHLIB_SUFFIX_DEPTH=2
             ;;
-        alpha-*-netbsd*|mips-*-netbsd*|powerpc-*-netbsd*)
-            CFLAGS_SHLIB="-fpic -DPIC"
-            LDFLAGS_SHLIB="-shared"
-            LDFLAGS_SHLIB_EXPORT=""
-            SHLIB_SUFFIX_DEPTH=2
-            ;;
         *-netbsd*)
-            CFLAGS_SHLIB="-fpic -DPIC"
+            CFLAGS_SHLIB="-fPIC -DPIC"
+if echo __ELF__ | ${CC} -E - | grep -q __ELF__; then
             LDFLAGS_SHLIB="-Bshareable"
             LDFLAGS_SHLIB_EXPORT=""
+else
+            LDFLAGS_SHLIB="-shared"
+            LDFLAGS_SHLIB_EXPORT="-Wl,-E"
+fi
             SHLIB_SUFFIX_DEPTH=2
             ;;
         *-apple-rhapsody*)
