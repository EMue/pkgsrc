$NetBSD: patch-aa,v 1.3 1998/10/28 01:29:16 hubertf Exp $

--- signal.c.orig	Thu May  2 22:03:39 1996
+++ signal.c	Wed Oct 28 02:03:15 1998
@@ -98,8 +98,14 @@
 	if (s >= 0 && s < NSIG) {
 		handler[s] = h;
 
-		sa.sa_handler = generichandler;
+		sa.sa_handler = (void (*)())generichandler;
+#if defined(__LIBC12_SOURCE__)
 		sa.sa_mask = sigmask(SIGIO) | sigmask(SIGALRM);
+#else
+		sigemptyset(&sa.sa_mask);
+		sigaddset(&sa.sa_mask, SIGIO);
+		sigaddset(&sa.sa_mask, SIGALRM);
+#endif
 		sa.sa_flags = SA_ONSTACK;
 		sigaction(s, &sa, NULL);
 
