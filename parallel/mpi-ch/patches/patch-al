$NetBSD: patch-al,v 1.5 2001/03/21 15:29:00 wennmach Exp $

Adopt to pkg hierarchy.

--- util/mpiinstall.in.orig	Thu Aug 24 18:21:36 2000
+++ util/mpiinstall.in	Wed Mar 21 14:40:13 2001
@@ -446,9 +446,11 @@
 MkDir $docdir
 MkDir $sysconfdir
 
-MkDir $prefix/examples
+MkDir $prefix/share/util
+MkDir $prefix/share/util/machines
+MkDir $prefix/share/examples/mpi-ch
 if [ -n "$CPP_DIR" -a "$buildcpp" = 1 ] ; then 
-    MkDir $prefix/examples/$CPP_DIR
+    MkDir $prefix/share/examples/mpi-ch/$CPP_DIR
     MkDir $includedir/mpi2c++
 fi
 
@@ -648,7 +650,7 @@
     #	$CPRP -r util/machines $prefix/util/machines.anl
     for file in util/machines/machines* ; do
         if [ -s $file ] ; then 
-            CopyFile $file $datadir
+            CopyFile $file $prefix/share/util/machines
 	fi
     done
     #
@@ -868,7 +870,7 @@
 CopyFile $top_srcdir/util/cleanipcs $sbindir $XMODE
 #
 # Example programs
-CopyFile $top_srcdir/installtest/Makefile.in $prefix/examples
+CopyFile $top_srcdir/installtest/Makefile.in $prefix/share/examples/mpi-ch
 #
 # This SHOULD use mpireconfig...
 Savevar=$prefix
@@ -876,44 +878,44 @@
 # prefix=@prefix@ when ever prefix= starts in the first column (!)
 # It also does this with exec_prefix (!!)
      prefix=$APREFIX
-(cd $prefix/examples ; $bindir/mpireconfig Makefile )
-echo "(cd $prefix/examples ; $MAKE clean)" >> $UNINSTALLFILE
-echo "/bin/rm -f $prefix/examples/Makefile" >> $UNINSTALLFILE
+(cd $prefix/share/examples/mpi-ch ; $bindir/mpireconfig Makefile )
+echo "(cd $prefix/share/examples/mpi-ch ; $MAKE clean)" >> $UNINSTALLFILE
+echo "/bin/rm -f $prefix/share/examples/mpi-ch/Makefile" >> $UNINSTALLFILE
      prefix=$Savevar
-CopyFile $prefix/examples/Makefile $datadir/Makefile.sample
-CopyFile $top_srcdir/installtest/cpi.c $prefix/examples
-CopyFile $top_srcdir/installtest/cpip.c $prefix/examples
-CopyFile $top_srcdir/installtest/cpilog.c $prefix/examples
-CopyFile $top_srcdir/installtest/hello++.cc $prefix/examples
+CopyFile $prefix/share/examples/mpi-ch/Makefile $prefix/share/examples/mpi-ch/Makefile.sample
+CopyFile $top_srcdir/installtest/cpi.c $prefix/share/examples/mpi-ch
+CopyFile $top_srcdir/installtest/cpip.c $prefix/share/examples/mpi-ch
+CopyFile $top_srcdir/installtest/cpilog.c $prefix/share/examples/mpi-ch
+CopyFile $top_srcdir/installtest/hello++.cc $prefix/share/examples/mpi-ch
 if [ "@NOF77@" = "0" ] ; then
-    CopyFile $top_srcdir/installtest/pi3.f $prefix/examples
-    CopyFile $top_srcdir/installtest/pi3p.f $prefix/examples
+    CopyFile $top_srcdir/installtest/pi3.f $prefix/share/examples/mpi-ch
+    CopyFile $top_srcdir/installtest/pi3p.f $prefix/share/examples/mpi-ch
     if [ "@NO_F90@" = "0" ] ; then
-        CopyFile $top_srcdir/installtest/pi3f90.f90 $prefix/examples
+        CopyFile $top_srcdir/installtest/pi3f90.f90 $prefix/share/examples/mpi-ch
     fi
 fi
 if [ -s $top_srcdir/romio/test/simple.c ] ; then 
-    CopyFile $top_srcdir/romio/test/simple.c $prefix/examples/simpleio.c
+    CopyFile $top_srcdir/romio/test/simple.c $prefix/share/examples/mpi-ch/simpleio.c
 fi
-CopyFile $top_srcdir/installtest/README $prefix/examples
+CopyFile $top_srcdir/installtest/README $prefix/share/examples/mpi-ch
 #
 # Test build the examples
-$Show "(cd $prefix/examples ; /bin/rm -f mpirun ; \
-	  ln -s ../bin/mpirun mpirun )"
-echo "/bin/rm -f $prefix/examples/mpirun" >> $UNINSTALLFILE
+$Show "(cd $prefix/share/examples/mpi-ch ; /bin/rm -f mpirun ; \
+	  ln -s $bindir/mpirun mpirun )"
+echo "/bin/rm -f $prefix/share/examples/mpi-ch/mpirun" >> $UNINSTALLFILE
 #
 echo "About to run installation test..."
-$Show "(cd $prefix/examples; $MAKE all ; $MAKE clean )"
+$Show "(cd $prefix/share/examples/mpi-ch; $MAKE all ; $MAKE clean )"
 if [ @SHAREDKIND@ != "ignore" ] ; then
     echo "About to run installation test for shared libraries ..."
-    $Show "(cd $prefix/examples; MPICH_USE_SHLIB="yes"; export MPICH_USE_SHLIB; $MAKE all ; $MAKE clean )"
+    $Show "(cd $prefix/share/examples/mpi-ch; MPICH_USE_SHLIB="yes"; export MPICH_USE_SHLIB; $MAKE all ; $MAKE clean )"
 fi
 #
 # This SHOULD use mpireconfig...
 Savevar=$prefix
 if [ -n "$CPP_DIR" -a "$buildcpp" = 1 ] ; then 
     # C++ Example programs 
-    CopyFile $top_srcdir/installtest/mpi-2-c++/Makefile.in $prefix/examples/$CPP_DIR
+    CopyFile $top_srcdir/installtest/mpi-2-c++/Makefile.in $prefix/share/examples/mpi-ch/$CPP_DIR
     #
     prefix=$APREFIX
     CPPEXDIR=$top_srcdir/$CPP_DIR/contrib/examples
@@ -921,25 +923,25 @@
     # the C++ examples Makefile, particularly the TEMPLATE_REP field
     # The intent here is to update the directories; but we also need
     # to update a few additional fields
-    (cd $prefix/examples/$CPP_DIR ; $bindir/mpireconfig Makefile )
-    echo "(cd $prefix/examples/$CPP_DIR ; $MAKE clean)" >> $UNINSTALLFILE
-    echo "/bin/rm -f $prefix/examples/$CPP_DIR/Makefile" >> $UNINSTALLFILE
+    (cd $prefix/share/examples/mpi-ch/$CPP_DIR ; $bindir/mpireconfig Makefile )
+    echo "(cd $prefix/share/examples/mpi-ch/$CPP_DIR ; $MAKE clean)" >> $UNINSTALLFILE
+    echo "/bin/rm -f $prefix/share/examples/mpi-ch/$CPP_DIR/Makefile" >> $UNINSTALLFILE
     prefix=$Savevar
-    CopyFile $CPPEXDIR/hello_world.cc $prefix/examples/$CPP_DIR
-    CopyFile $CPPEXDIR/ring.cc $prefix/examples/$CPP_DIR
-    CopyFile $CPPEXDIR/topology.cc $prefix/examples/$CPP_DIR
-    CopyFile $CPPEXDIR/user_bcast.cc $prefix/examples/$CPP_DIR
-    CopyFile $CPPEXDIR/chapter_10_mpi2.cc $prefix/examples/$CPP_DIR
-    CopyFile $CPPEXDIR/pi.cc $prefix/examples/$CPP_DIR
-    CopyFile $CPPEXDIR/README $prefix/examples/$CPP_DIR
+    CopyFile $CPPEXDIR/hello_world.cc $prefix/share/examples/mpi-ch/$CPP_DIR
+    CopyFile $CPPEXDIR/ring.cc $prefix/share/examples/mpi-ch/$CPP_DIR
+    CopyFile $CPPEXDIR/topology.cc $prefix/share/examples/mpi-ch/$CPP_DIR
+    CopyFile $CPPEXDIR/user_bcast.cc $prefix/share/examples/mpi-ch/$CPP_DIR
+    CopyFile $CPPEXDIR/chapter_10_mpi2.cc $prefix/share/examples/mpi-ch/$CPP_DIR
+    CopyFile $CPPEXDIR/pi.cc $prefix/share/examples/mpi-ch/$CPP_DIR
+    CopyFile $CPPEXDIR/README $prefix/share/examples/mpi-ch/$CPP_DIR
     #
     # Test build the C++ examples
-    $Show "(cd $prefix/examples/$CPP_DIR ; /bin/rm -f mpirun ; \
-	      ln -s ../../bin/mpirun mpirun )"
-    echo "/bin/rm -f $prefix/examples/$CPP_DIR/mpirun" >> $UNINSTALLFILE
+    $Show "(cd $prefix/share/examples/mpi-ch/$CPP_DIR ; /bin/rm -f mpirun ; \
+	ln -s $bindir/mpirun mpirun )"
+    echo "/bin/rm -f $prefix/share/examples/mpi-ch/$CPP_DIR/mpirun" >> $UNINSTALLFILE
     #
     echo "About to run C++ installation test..."
-    $Show "(cd $prefix/examples/$CPP_DIR; $MAKE ; $MAKE clean)"
+    $Show "(cd $prefix/share/examples/mpi-ch/$CPP_DIR; $MAKE ; $MAKE clean)"
     #
 fi
 #
