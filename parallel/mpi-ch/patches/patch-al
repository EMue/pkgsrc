$NetBSD: patch-al,v 1.3 1998/11/12 23:45:54 frueauf Exp $

--- util/mpiinstall.in.orig	Sun Jul 12 08:28:14 1998
+++ util/mpiinstall.in	Tue Oct 20 14:57:33 1998
@@ -120,12 +120,12 @@
 # script from the library directory itself.
 if [ -n "$libonly" ] ; then
 #   trialname=`sed -n -e "s/DEFAULT_MACHINE='\(.*\)'/\1/p" \
-#	lib/$ARCH/$COMM/config.status`
+#	libdata/$ARCH/$COMM/config.status`
 #   if [ -n "$trialname" ] ; then 
 #	DEFAULT_MACHINE="$trialname"
 #   fi
-    if [ $inlib = 0 -a -x lib/$ARCH/$COMM/mpiinstall ] ; then
-        ./lib/$ARCH/$COMM/mpiinstall -inlib "$@"
+    if [ $inlib = 0 -a -x libdata/$ARCH/$COMM/mpiinstall ] ; then
+        ./libdata/$ARCH/$COMM/mpiinstall -inlib "$@"
         exit $?
     fi
 fi
@@ -134,15 +134,15 @@
 # These work by extracting the syntax for specifying the library, and then
 # adding the correct destination to it.
 NFLIB_PATH=`echo "@FLIB_PATH@" | \
-	sed -e "s%^\([^/ ]*\)/[^ ]*%\1$PREFIX/lib/$ARCH/$COMM%g"`
+	sed -e "s%^\([^/ ]*\)/[^ ]*%\1$PREFIX/libdata/$ARCH/$COMM%g"`
 NF90LIB_PATH=`echo "@F90LIB_PATH@" | \
-	sed -e "s%^\([^/ ]*\)/[^ ]*%\1$PREFIX/lib/$ARCH/$COMM%g"`
+	sed -e "s%^\([^/ ]*\)/[^ ]*%\1$PREFIX/libdata/$ARCH/$COMM%g"`
 NF90INC=`echo "@F90INC@" | \
 	sed -e "s%^\([^/ ]*\)/[^ ]*%\1$PREFIX/include%g"`
 # This one is especially tricky because the default include path goes to the
 # source directory for the C++ interface
 NCPPFLAGS=`echo "A$CPPFLAGS" | \
-    sed -e "s%-I.*/MPI-2-C++/src%-I$PREFIX/lib/$ARCH/$COMM/c++%g" \
+    sed -e "s%-I.*/MPI-2-C++/src%-I$PREFIX/libdata/$ARCH/$COMM/c++%g" \
         -e "s/^A//g"`
 #
 # Remove old uninstall file
@@ -269,9 +269,10 @@
     if [ -f $dest ] ; then $Show /bin/rm -f $dest ; fi
     if [ $just_testing = 0 ] ; then
         sed \
+	-e "s%/lib/%/libdata/%g" \
 	-e "s%\#ARCH\#%$ARCH%g" \
 	-e "s%\#AUTOMOUNTFIX\#%@AUTOMOUNTFIX@%g" \
-        -e "s%\#BITMAP_DIR\#%$PREFIX/lib/bitmaps%g" \
+        -e "s%\#BITMAP_DIR\#%$PREFIX/libdata/bitmaps%g" \
 	-e "s%\#CC\#%@CC@%g" \
 	-e "s%\#CFLAGS\#%@CFLAGS@%g" \
 	-e "s%\#USER_CFLAGS\#%@USER_CFLAGS@%g" \
@@ -280,7 +281,7 @@
 	-e "s%\#DEFAULT_ARCH\#%$ARCH%g" \
 	-e "s%\#DEFAULT_DEVICE\#%$DEVICE%g" \
 	-e "s%\#DEFAULT_MACHINE\#%$DEFAULT_MACHINE%g" \
-       	-e "s%\#EXECER_DIR\#%$PREFIX/util%g" \
+       	-e "s%\#EXECER_DIR\#%$PREFIX/share/util%g" \
 	-e "s%\#F77\#%@F77@%g" \
 	-e "s%\#FFLAGS\#%@FFLAGS@%g" \
 	-e "s%\#FLIB_PATH_LEADER\#%@FLIB_PATH_LEADER@%g" \
@@ -342,7 +343,7 @@
     # the LIB_PATH to contain multiple names, as long as the MPICH libpath
     # is first
     NLIBPATH=`echo "@LIB_PATH@" | \
-	sed -e "s%^\([^/ ]*\)/[^ ]*%\1$PREFIX/lib/$ARCH/$COMM%g"`
+	sed -e "s%^\([^/ ]*\)/[^ ]*%\1$PREFIX/libdata/$ARCH/$COMM%g"`
 if [ -d $2 ] ; then
     dest=$2/`basename $1`
 else
@@ -356,11 +357,12 @@
     if [ -f $dest ] ; then $Show /bin/rm -f $dest ; fi
     if [ $just_testing = 0 ] ; then
         sed \
+	-e "s%/lib/%/libdata/%g" \
 	-e "s%[@]ARCH[@]%$ARCH%g" \
 	-e "s%[@]AUTOMOUNTFIX[@]%@AUTOMOUNTFIX@%g" \
 	-e "s%[@]FINC[@]%$NFINC%g" \
 	-e "s%[@]F90INC[@]%$NF90INC%g" \
-        -e "s%[@]BITMAP_DIR[@]%$PREFIX/lib/bitmaps%g" \
+        -e "s%[@]BITMAP_DIR[@]%$PREFIX/libdata/bitmaps%g" \
 	-e "s%[@]CC[@]%@CC@%g" \
 	-e "s%[@]CCC[@]%@CCC@%g" \
 	-e "s%[@]CPP_COMPILER[@]%@CPP_COMPILER@%g" \
@@ -375,7 +377,7 @@
 	-e "s%[@]DEFAULT_ARCH[@]%$ARCH%g" \
 	-e "s%[@]DEFAULT_DEVICE[@]%$DEVICE%g" \
 	-e "s%[@]DEFAULT_MACHINE[@]%$DEFAULT_MACHINE%g" \
-       	-e "s%[@]EXECER_DIR[@]%$PREFIX/util%g" \
+       	-e "s%[@]EXECER_DIR[@]%$PREFIX/share/util%g" \
 	-e "s%[@]F77[@]%@F77@%g" \
 	-e "s%[@]FFLAGS[@]%@FFLAGS@%g" \
 	-e "s%[@]FLIB_PATH_LEADER[@]%@FLIB_PATH_LEADER@%g" \
@@ -455,22 +457,23 @@
     MkDir $PREFIX 
 fi
 
-MkDir $PREFIX/lib
-MkDir $PREFIX/lib/$ARCH
-MkDir $PREFIX/lib/$ARCH/$COMM
-MkDir $PREFIX/lib/bitmaps
+MkDir $PREFIX/libdata
+MkDir $PREFIX/libdata/$ARCH
+MkDir $PREFIX/libdata/$ARCH/$COMM
+MkDir $PREFIX/libdata/bitmaps
 if [ -n "$CPP_DIR" -a "$buildcpp" = 1 ] ; then 
-    MkDir $PREFIX/$CPP_DIR
-    MkDir $PREFIX/$CPP_DIR/examples
-    MkDir $PREFIX/lib/$ARCH/$COMM/c++
+#    MkDir $PREFIX/libdata/$CPP_DIR
+    MkDir $PREFIX/share/examples/$CPP_DIR
+    MkDir $PREFIX/libdata/$ARCH/$COMM/c++
 fi
-MkDir $PREFIX/util
-MkDir $PREFIX/util/machines
+MkDir $PREFIX/share/util
+MkDir $PREFIX/share/util/machines
 MkDir $PREFIX/include
-MkDir $PREFIX/examples
+MkDir $PREFIX/share/examples/mpi
 MkDir $PREFIX/bin
 MkDir $PREFIX/man
-MkDir $PREFIX/doc
+MkDir $PREFIX/share/doc
+MkDir $PREFIX/share/doc/mpi
 if [ -z "$libonly" ] ; then
     CopyFile bin/tarch $PREFIX/bin $XMODE
     CopyFile bin/tdevice $PREFIX/bin $XMODE
@@ -478,7 +481,7 @@
     # mpiman
     $Show /bin/rm -f $PREFIX/bin/mpiman
     FixupFile util/mpiman.in $PREFIX/bin/mpiman $XMODE
-    CopyFile $PREFIX/bin/mpiman $PREFIX/lib/$ARCH/$COMM $XMODE
+    CopyFile $PREFIX/bin/mpiman $PREFIX/libdata/$ARCH/$COMM $XMODE
     #
     # Upshot and Nupshot
     # Do Upshot/Nupshot early in case there is a problem.
@@ -488,7 +491,7 @@
         #
         # Should clean nupshot sources  (*.c/h) 
         if [ -n "@TCL_DIR@" -a -z "$cpnupshot" -a -n "@TK_DIR@" -a \
-	   "@TK_VERSION@" = "3.6" ] ; then 
+	   "@TK_VERSION@" = "8.0" ] ; then 
             echo "Attempting to build nupshot... "
             $Show $CPRP -r mpe/profiling/nupshot $PREFIX
 	    echo "/bin/rm -rf $PREFIX/nupshot" >> $UNINSTALLFILE
@@ -526,16 +529,16 @@
             echo "Creating $PREFIX/bin/$bfile from $file"
         fi
         FixupFile $file $PREFIX/bin/$bfile $XMODE
-        $Show /bin/rm -f $PREFIX/lib/$ARCH/$COMM/$bfile 
-        CopyFile $PREFIX/bin/$bfile $PREFIX/lib/$ARCH/$COMM $XMODE
+        $Show /bin/rm -f $PREFIX/libdata/$ARCH/$COMM/$bfile 
+        CopyFile $PREFIX/bin/$bfile $PREFIX/libdata/$ARCH/$COMM $XMODE
     done
     $Show mv $PREFIX/bin/mpirun.sh $PREFIX/bin/mpirun
     echo "/bin/rm -f $PREFIX/bin/mpirun" >> $UNINSTALLFILE
-    $Show mv $PREFIX/lib/$ARCH/$COMM/mpirun.sh $PREFIX/lib/$ARCH/$COMM/mpirun
-    echo "/bin/rm -f $PREFIX/lib/$ARCH/$COMM/mpirun" >> $UNINSTALLFILE
-    if [ ! -r $PREFIX/lib/$ARCH/$COMM/tarch ] ; then
-	( cd $PREFIX/lib/$ARCH/$COMM ; 	ln -s ../../../bin/tarch tarch )
-        echo "/bin/rm -f $PREFIX/lib/$ARCH/$COMM/tarch" >> $UNINSTALLFILE
+    $Show mv $PREFIX/libdata/$ARCH/$COMM/mpirun.sh $PREFIX/libdata/$ARCH/$COMM/mpirun
+    echo "/bin/rm -f $PREFIX/libdata/$ARCH/$COMM/mpirun" >> $UNINSTALLFILE
+    if [ ! -r $PREFIX/libdata/$ARCH/$COMM/tarch ] ; then
+	( cd $PREFIX/libdata/$ARCH/$COMM ; 	ln -s ../../../bin/tarch tarch )
+        echo "/bin/rm -f $PREFIX/libdata/$ARCH/$COMM/tarch" >> $UNINSTALLFILE
     fi
     #
     $Show /bin/rm -f $PREFIX/bin/mpireconfig
@@ -543,22 +546,22 @@
         echo "Creating mpireconfig from util/mpireconfig.in"
     fi
     FixupFile util/mpireconfig.in $PREFIX/bin/mpireconfig $XMODE
-    CopyFile $PREFIX/bin/mpireconfig $PREFIX/lib/$ARCH/$COMM $XMODE
+    CopyFile $PREFIX/bin/mpireconfig $PREFIX/libdata/$ARCH/$COMM $XMODE
     $Show /bin/rm -f $PREFIX/bin/execer
     CopyFile util/execer $PREFIX/bin/execer $XMODE
     #
     # mpicc, mpif77, mpif90
     FixupFileWithAt util/mpicc.in $PREFIX/bin/mpicc $XMODE
-    CopyFile $PREFIX/bin/mpicc $PREFIX/lib/$ARCH/$COMM $XMODE
+    CopyFile $PREFIX/bin/mpicc $PREFIX/libdata/$ARCH/$COMM $XMODE
     FixupFileWithAt util/mpif77.in $PREFIX/bin/mpif77 $XMODE
-    CopyFile $PREFIX/bin/mpif77 $PREFIX/lib/$ARCH/$COMM $XMODE
+    CopyFile $PREFIX/bin/mpif77 $PREFIX/libdata/$ARCH/$COMM $XMODE
     FixupFileWithAt util/mpif90.in $PREFIX/bin/mpif90 $XMODE
-    CopyFile $PREFIX/bin/mpif90 $PREFIX/lib/$ARCH/$COMM $XMODE
+    CopyFile $PREFIX/bin/mpif90 $PREFIX/libdata/$ARCH/$COMM $XMODE
     #
     # mpiCC, if C++ selected
     if [ -n "@CPP_COMPILER@" ] ; then
 	FixupFileWithAt util/mpiCC.in $PREFIX/bin/mpiCC $XMODE
-        CopyFile $PREFIX/bin/mpiCC $PREFIX/lib/$ARCH/$COMM $XMODE
+        CopyFile $PREFIX/bin/mpiCC $PREFIX/libdata/$ARCH/$COMM $XMODE
     fi
 else
     # libonly
@@ -568,28 +571,28 @@
     for file in util/mpirun.*.in util/tstmachines.in ; do
         bfile=`basename $file .in`
         if [ $verbose = 1 ] ; then 
-            echo "Creating $PREFIX/lib/$ARCH/$COMM/$bfile from $file"
+            echo "Creating $PREFIX/libdata/$ARCH/$COMM/$bfile from $file"
 	fi
-        FixupFile $file $PREFIX/lib/$ARCH/$COMM/$bfile $XMODE
+        FixupFile $file $PREFIX/libdata/$ARCH/$COMM/$bfile $XMODE
     done
-    $Show mv $PREFIX/lib/$ARCH/$COMM/mpirun.sh $PREFIX/lib/$ARCH/$COMM/mpirun
-    if [ ! -r $PREFIX/lib/$ARCH/$COMM/tarch ] ; then
-	( cd $PREFIX/lib/$ARCH/$COMM ; 	ln -s ../../../bin/tarch tarch )
-        echo "/bin/rm -f $PREFIX/lib/$ARCH/$COMM/tarch" >> $UNINSTALLFILE
+    $Show mv $PREFIX/libdata/$ARCH/$COMM/mpirun.sh $PREFIX/libdata/$ARCH/$COMM/mpirun
+    if [ ! -r $PREFIX/libdata/$ARCH/$COMM/tarch ] ; then
+	( cd $PREFIX/libdata/$ARCH/$COMM ; 	ln -s ../../../bin/tarch tarch )
+        echo "/bin/rm -f $PREFIX/libdata/$ARCH/$COMM/tarch" >> $UNINSTALLFILE
     fi
-    FixupFileWithAt util/mpicc.in $PREFIX/lib/$ARCH/$COMM/mpicc $XMODE
+    FixupFileWithAt util/mpicc.in $PREFIX/libdata/$ARCH/$COMM/mpicc $XMODE
     if [ -n "@CPP_COMPILER@" ] ; then
-        FixupFileWithAt util/mpiCC.in $PREFIX/lib/$ARCH/$COMM/mpiCC $XMODE
+        FixupFileWithAt util/mpiCC.in $PREFIX/libdata/$ARCH/$COMM/mpiCC $XMODE
     fi
-    FixupFileWithAt util/mpif77.in $PREFIX/lib/$ARCH/$COMM/mpif77 $XMODE
-    FixupFileWithAt util/mpif90.in $PREFIX/lib/$ARCH/$COMM/mpif90 $XMODE
-    FixupFile util/mpireconfig.in $PREFIX/lib/$ARCH/$COMM/mpireconfig $XMODE
-    CopyFile lib/$ARCH/$COMM/mpichconf.h $PREFIX/lib/$ARCH/$COMM
-    CopyFile lib/$ARCH/$COMM/mpidefs.h $PREFIX/lib/$ARCH/$COMM
-    CopyFile lib/$ARCH/$COMM/mpif.h    $PREFIX/lib/$ARCH/$COMM
+    FixupFileWithAt util/mpif77.in $PREFIX/libdata/$ARCH/$COMM/mpif77 $XMODE
+    FixupFileWithAt util/mpif90.in $PREFIX/libdata/$ARCH/$COMM/mpif90 $XMODE
+    FixupFile util/mpireconfig.in $PREFIX/libdata/$ARCH/$COMM/mpireconfig $XMODE
+    CopyFile lib/$ARCH/$COMM/mpichconf.h $PREFIX/libdata/$ARCH/$COMM
+    CopyFile lib/$ARCH/$COMM/mpidefs.h $PREFIX/libdata/$ARCH/$COMM
+    CopyFile lib/$ARCH/$COMM/mpif.h    $PREFIX/libdata/$ARCH/$COMM
     if [ -s romio/include/mpio.h ] ; then
-        CopyFile romio/include/mpio.h $PREFIX/lib/$ARCH/$COMM
-        CopyFile romio/include/mpiof.h $PREFIX/lib/$ARCH/$COMM
+        CopyFile romio/include/mpio.h $PREFIX/libdata/$ARCH/$COMM
+        CopyFile romio/include/mpiof.h $PREFIX/libdata/$ARCH/$COMM
     fi
 fi
 #
@@ -599,12 +602,12 @@
     echo "Attempting to build ch_p4 secure server"
     $Show "( cd mpid/ch_p4/p4/servers ; $MAKE serv_p4 ; )" 
     CopyFile mpid/ch_p4/p4/bin/serv_p4 $PREFIX/bin $XMODE
-    CopyFile $PREFIX/bin/serv_p4 $PREFIX/lib/$ARCH/$COMM $XMODE
+    CopyFile $PREFIX/bin/serv_p4 $PREFIX/libdata/$ARCH/$COMM $XMODE
     $Show /bin/rm -f util/chp4_servs
-    FixupFile util/chp4_servs.in $PREFIX/util/chp4_servs $XMODE
-    CopyFile $PREFIX/util/chp4_servs $PREFIX/lib/$ARCH/$COMM $XMODE
-    CopyFile util/chkserv $PREFIX/util/chkserv $XMODE
-    CopyFile $PREFIX/util/chkserv $PREFIX/lib/$ARCH/$COMM $XMODE
+    FixupFile util/chp4_servs.in $PREFIX/share/util/chp4_servs $XMODE
+    CopyFile $PREFIX/share/util/chp4_servs $PREFIX/libdata/$ARCH/$COMM $XMODE
+    CopyFile util/chkserv $PREFIX/share/util/chkserv $XMODE
+    CopyFile $PREFIX/share/util/chkserv $PREFIX/libdata/$ARCH/$COMM $XMODE
 fi
 #
 # P4
@@ -615,12 +618,12 @@
     fi
     if [ -x mpid/server/server ] ; then 
 	CopyFile mpid/server/server $PREFIX/bin $XMODE
-        CopyFile mpid/server/server $PREFIX/lib/$ARCH/$COMM $XMODE
+        CopyFile mpid/server/server $PREFIX/libdata/$ARCH/$COMM $XMODE
 	$Show /bin/rm -f util/chp4_servs
-	FixupFile util/chp4_servs.in $PREFIX/util/chp4_servs $XMODE
-	CopyFile $PREFIX/util/chp4_servs $PREFIX/lib/$ARCH/$COMM $XMODE
-	CopyFile util/chkserv $PREFIX/util/chkserv $XMODE
-	CopyFile $PREFIX/util/chkserv $PREFIX/lib/$ARCH/$COMM $XMODE
+	FixupFile util/chp4_servs.in $PREFIX/share/util/chp4_servs $XMODE
+	CopyFile $PREFIX/share/util/chp4_servs $PREFIX/libdata/$ARCH/$COMM $XMODE
+	CopyFile util/chkserv $PREFIX/share/util/chkserv $XMODE
+	CopyFile $PREFIX/share/util/chkserv $PREFIX/libdata/$ARCH/$COMM $XMODE
     else
         echo "Server not available"
     fi
@@ -629,15 +632,15 @@
 if [ -z "$libonly" ] ; then
     #
     # Machines database
-    #	if [ ! -d $PREFIX/util/machines.anl ] ; then \
-    #	    mkdir $PREFIX/util/machines.anl ; fi
-    #	$CPRP -r util/machines $PREFIX/util/machines.anl
+    #	if [ ! -d $PREFIX/share/util/machines.anl ] ; then \
+    #	    mkdir $PREFIX/share/util/machines.anl ; fi
+    #	$CPRP -r util/machines $PREFIX/share/util/machines.anl
     for file in util/machines/machines* ; do
-        CopyFile $file $PREFIX/util/machines
+        CopyFile $file $PREFIX/share/util/machines
     done
     for file in mpe/profiling/upshot/bitmaps/* ; do 
 	if [ -f $file ] ; then 
-            CopyFile $file $PREFIX/lib/bitmaps
+            CopyFile $file $PREFIX/libdata/bitmaps
 	fi
     done
     #
@@ -649,33 +652,33 @@
     CopyFile include/protofix.h $PREFIX/include
     CopyFile include/mpeexten.h $PREFIX/include
     CopyFile include/patchlevel.h $PREFIX/include
-    CopyFile lib/$ARCH/$COMM/mpichconf.h $PREFIX/lib/$ARCH/$COMM
-    CopyFile lib/$ARCH/$COMM/mpidefs.h $PREFIX/lib/$ARCH/$COMM
+    CopyFile lib/$ARCH/$COMM/mpichconf.h $PREFIX/libdata/$ARCH/$COMM
+    CopyFile lib/$ARCH/$COMM/mpidefs.h $PREFIX/libdata/$ARCH/$COMM
     CopyFile mpe/mpe.h $PREFIX/include
     CopyFile mpe/mpe_graphics.h $PREFIX/include
     CopyFile mpe/mpe_log.h $PREFIX/include
     CopyFile mpe/mpetools.h $PREFIX/include
     CopyFile mpe/basex11.h $PREFIX/include
     if [ -s romio/include/mpio.h ] ; then
-        CopyFile romio/include/mpio.h $PREFIX/lib/$ARCH/$COMM
-        CopyFile romio/include/mpiof.h $PREFIX/lib/$ARCH/$COMM
+        CopyFile romio/include/mpio.h $PREFIX/libdata/$ARCH/$COMM
+        CopyFile romio/include/mpiof.h $PREFIX/libdata/$ARCH/$COMM
     fi
 fi
 #
 # Include files for C++
 if [ -n "$CPP_DIR" -a "$buildcpp" = 1 ] ; then 
-    if [ ! -d $PREFIX/lib/$ARCH/$COMM/c++ ] ; then
-        MkDir $PREFIX/lib/$ARCH/$COMM/c++
+    if [ ! -d $PREFIX/libdata/$ARCH/$COMM/c++ ] ; then
+        MkDir $PREFIX/libdata/$ARCH/$COMM/c++
     fi
     for file in `ls MPI-2-C++/src/*.h`; do 
-        CopyFile $file $PREFIX/lib/$ARCH/$COMM/c++
+        CopyFile $file $PREFIX/libdata/$ARCH/$COMM/c++
     done
 fi
 #
 # Libaries (includeing shared libraries)
 for file in lib/$ARCH/$COMM/*.a lib/$ARCH/$COMM/*.so* ; do
     if [ -f $file ] ; then 
-        CopyFileP $file $PREFIX/lib/$ARCH/$COMM
+        CopyFileP $file $PREFIX/libdata/$ARCH/$COMM
     fi
 done
 #
@@ -684,7 +687,7 @@
 #     spxcp - Executable copy program for IBM SP.
 for file in spxcp ; do
     if [ -x lib/$ARCH/$COMM/$file ] ; then 
-        CopyFileP lib/$ARCH/$COMM/$file $PREFIX/lib/$ARCH/$COMM
+        CopyFileP lib/$ARCH/$COMM/$file $PREFIX/libdata/$ARCH/$COMM
     fi
 done
 #
@@ -696,18 +699,18 @@
         if [ $file = "mpich.cat" ] ; then
 	    # This is a link; it assumes that En_US is the default.
             if [ -f lib/$ARCH/mpich.En_US.cat ] ; then 
-                $Show ln -s $PREFIX/lib/$ARCH/mpich.En_US.cat \
-	   		    $PREFIX/lib/$ARCH/mpich.cat
+                $Show ln -s $PREFIX/libdata/$ARCH/mpich.En_US.cat \
+	   		    $PREFIX/libdata/$ARCH/mpich.cat
             fi
         elif [ -s $file ] ; then 
 	    # This will handle the case of no mpich.* matches
-            CopyFile $file $PREFIX/lib/$ARCH
+            CopyFile $file $PREFIX/libdata/$ARCH
         fi
     done
 fi
     
 # Other files in lib need to be updated...
-CopyFile lib/$ARCH/$COMM/mpidefs.h $PREFIX/lib/$ARCH/$COMM
+CopyFile lib/$ARCH/$COMM/mpidefs.h $PREFIX/libdata/$ARCH/$COMM
 #
 # Documentation
 # Note that we're not doing the www pages yet.
@@ -735,15 +738,15 @@
 if [ -z "$libonly" ] ; then
     for file in functions.ps.Z guide.ps.Z install.ps.Z ; do
 	if [ -f $file ] ; then 
-            CopyFile doc/$file $PREFIX/doc
+            CopyFile doc/$file $PREFIX/share/doc/mpi
 	fi
     done
     #$Show $CPRP -r doc $PREFIX
     if [ -f ref/adiman.ps.Z ] ; then 
-        CopyFile ref/adiman.ps.Z $PREFIX/doc
+        CopyFile ref/adiman.ps.Z $PREFIX/share/doc/mpi
     fi
     if [ -f ref/mpiman.ps.Z ] ; then 
-        CopyFile ref/mpiman.ps.Z $PREFIX/doc
+        CopyFile ref/mpiman.ps.Z $PREFIX/share/doc/mpi
     fi
 fi
 #
@@ -755,94 +758,94 @@
 if [ $just_testing = 0 ] ; then
     cat lib/$ARCH/$COMM/config.status | \
 	sed -e "s%MPIR_HOME=.*\$%MPIR_HOME='$PREFIX'%g" \
-    -e "s%^LIB_PATH=\([^/ ]*\)/[^ ']*%LIB_PATH=\1$PREFIX/lib/$ARCH/$COMM%g" \
-    -e "s%^FLIB_PATH=\([^/ ]*\)/[^ ']*%FLIB_PATH=\1$PREFIX/lib/$ARCH/$COMM%g" \
+    -e "s%^LIB_PATH=\([^/ ]*\)/[^ ']*%LIB_PATH=\1$PREFIX/libdata/$ARCH/$COMM%g" \
+    -e "s%^FLIB_PATH=\([^/ ]*\)/[^ ']*%FLIB_PATH=\1$PREFIX/libdata/$ARCH/$COMM%g" \
 		-e "s%MPE_DIR=.*\$%MPE_DIR='$PREFIX/mpe'%g" \
-    -e "s%^MPICC=\([^/ ]*\)/.*\$%MPICC=$PREFIX/lib/$ARCH/$COMM/mpicc%g" \
-    -e "s%^MPIF77=\([^/ ]*\)/.*\$%MPIF77=$PREFIX/lib/$ARCH/$COMM/mpif77%g" \
-    -e "s%^MPIF90=\([^/ ]*\)/.*\$%MPIF90=$PREFIX/lib/$ARCH/$COMM/mpif90%g" \
-    -e "s%^MPICPLUSPLUS=\([^/ ]*\)/.*\$%MPICPLUSPLUS=$PREFIX/lib/$ARCH/$COMM/mpiCC%g" \
-		        > $PREFIX/lib/$ARCH/$COMM/config.status 
-    echo "/bin/rm -f $PREFIX/lib/$ARCH/$COMM/config.status" >> $UNINSTALLFILE
-    chmod $XMODE $PREFIX/lib/$ARCH/$COMM/config.status 
+    -e "s%^MPICC=\([^/ ]*\)/.*\$%MPICC=$PREFIX/libdata/$ARCH/$COMM/mpicc%g" \
+    -e "s%^MPIF77=\([^/ ]*\)/.*\$%MPIF77=$PREFIX/libdata/$ARCH/$COMM/mpif77%g" \
+    -e "s%^MPIF90=\([^/ ]*\)/.*\$%MPIF90=$PREFIX/libdata/$ARCH/$COMM/mpif90%g" \
+    -e "s%^MPICPLUSPLUS=\([^/ ]*\)/.*\$%MPICPLUSPLUS=$PREFIX/libdata/$ARCH/$COMM/mpiCC%g" \
+		        > $PREFIX/libdata/$ARCH/$COMM/config.status 
+    echo "/bin/rm -f $PREFIX/libdata/$ARCH/$COMM/config.status" >> $UNINSTALLFILE
+    chmod $XMODE $PREFIX/libdata/$ARCH/$COMM/config.status 
 else 
 cat <<.
 cat lib/$ARCH/$COMM/config.status | \
 	sed -e "s%MPIR_HOME=.*\$%MPIR_HOME='$PREFIX'%g" \
-    -e "s%^LIB_PATH=\([^/ ]*\)/[^ ']*%LIB_PATH=\1$PREFIX/lib/$ARCH/$COMM%g" \
-    -e "s%^FLIB_PATH=\([^/ ]*\)/[^ ']*%FLIB_PATH=\1$PREFIX/lib/$ARCH/$COMM%g" \
+    -e "s%^LIB_PATH=\([^/ ]*\)/[^ ']*%LIB_PATH=\1$PREFIX/libdata/$ARCH/$COMM%g" \
+    -e "s%^FLIB_PATH=\([^/ ]*\)/[^ ']*%FLIB_PATH=\1$PREFIX/libdata/$ARCH/$COMM%g" \
 		-e "s%MPE_DIR=.*\$%MPE_DIR='$PREFIX/mpe'%g" \
-    -e "s%^MPICC=\([^/ ]*\)/.*\$%MPICC=$PREFIX/lib/$ARCH/$COMM/mpicc%g" \
-    -e "s%^MPIF77=\([^/ ]*\)/.*\$%MPIF77=$PREFIX/lib/$ARCH/$COMM/mpif77%g" \
-    -e "s%^MPIF90=\([^/ ]*\)/.*\$%MPIF90=$PREFIX/lib/$ARCH/$COMM/mpif90%g" \
-    -e "s%^MPICPLUSPLUS=\([^/ ]*\)/.*\$%MPICPLUSPLUS=$PREFIX/lib/$ARCH/$COMM/mpiCC%g" \
-		        > $PREFIX/lib/$ARCH/$COMM/config.status
-    chmod $XMODE $PREFIX/lib/$ARCH/$COMM/config.status 
+    -e "s%^MPICC=\([^/ ]*\)/.*\$%MPICC=$PREFIX/libdata/$ARCH/$COMM/mpicc%g" \
+    -e "s%^MPIF77=\([^/ ]*\)/.*\$%MPIF77=$PREFIX/libdata/$ARCH/$COMM/mpif77%g" \
+    -e "s%^MPIF90=\([^/ ]*\)/.*\$%MPIF90=$PREFIX/libdata/$ARCH/$COMM/mpif90%g" \
+    -e "s%^MPICPLUSPLUS=\([^/ ]*\)/.*\$%MPICPLUSPLUS=$PREFIX/libdata/$ARCH/$COMM/mpiCC%g" \
+		        > $PREFIX/libdata/$ARCH/$COMM/config.status
+    chmod $XMODE $PREFIX/libdata/$ARCH/$COMM/config.status 
 .
 fi
 if [ -z "$libonly" ] ; then
-    #CopyFile $PREFIX/lib/$ARCH/$COMM/config.status $PREFIX
+    #CopyFile $PREFIX/libdata/$ARCH/$COMM/config.status $PREFIX
     #
-    $Show /bin/rm -f $PREFIX/examples/mpif.h
-    $Show ln -s $PREFIX/include/mpif.h $PREFIX/examples/mpif.h
-    echo "/bin/rm -f $PREFIX/examples/mpif.h" >> $UNINSTALLFILE
+    $Show /bin/rm -f $PREFIX/share/examples/mpi/mpif.h
+    $Show ln -s $PREFIX/include/mpif.h $PREFIX/share/examples/mpi/mpif.h
+    echo "/bin/rm -f $PREFIX/share/examples/mpi/mpif.h" >> $UNINSTALLFILE
 fi
 #
 # Example programs
-CopyFile installtest/Makefile.in $PREFIX/examples
+CopyFile installtest/Makefile.in $PREFIX/share/examples/mpi
 #
 # This SHOULD use mpireconfig...
 Savevar=$PREFIX
 PREFIX=$APREFIX
-#FixupFile installtest/makefile.proto $PREFIX/examples/Makefile
-(cd $PREFIX/examples ; $PREFIX/lib/$ARCH/$COMM/mpireconfig Makefile )
-echo "(cd $PREFIX/examples ; $MAKE clean)" >> $UNINSTALLFILE
-echo "/bin/rm -f $PREFIX/examples/Makefile" >> $UNINSTALLFILE
+#FixupFile installtest/makefile.proto $PREFIX/wshare/examples/mpi/Makefile
+(cd $PREFIX/share/examples/mpi ; $PREFIX/libdata/$ARCH/$COMM/mpireconfig Makefile )
+echo "(cd $PREFIX/share/examples/mpi ; $MAKE clean)" >> $UNINSTALLFILE
+echo "/bin/rm -f $PREFIX/share/examples/mpi/Makefile" >> $UNINSTALLFILE
 PREFIX=$Savevar
-CopyFile $PREFIX/examples/Makefile $PREFIX/lib/$ARCH/$COMM/Makefile.sample
-CopyFile installtest/cpi.c $PREFIX/examples
-CopyFile installtest/pi3.f $PREFIX/examples
-CopyFile installtest/cpilog.c $PREFIX/examples
-CopyFile installtest/hello++.cc $PREFIX/examples
+CopyFile $PREFIX/share/examples/mpi/Makefile $PREFIX/libdata/$ARCH/$COMM/Makefile.sample
+CopyFile installtest/cpi.c $PREFIX/share/examples/mpi
+CopyFile installtest/pi3.f $PREFIX/share/examples/mpi
+CopyFile installtest/cpilog.c $PREFIX/share/examples/mpi
+CopyFile installtest/hello++.cc $PREFIX/share/examples/mpi
 if [ -s romio/test/simple.c ] ; then 
-    CopyFile romio/test/simple.c $PREFIX/examples/simpleio.c
+    CopyFile romio/test/simple.c $PREFIX/share/examples/mpi/simpleio.c
 fi
-CopyFile installtest/README $PREFIX/examples
+CopyFile installtest/README $PREFIX/share/examples/mpi
 #
 # Test build the examples
-$Show "(cd $PREFIX/examples ; /bin/rm -f mpirun ; \
+$Show "(cd $PREFIX/share/examples/mpi ; /bin/rm -f mpirun ; \
 	  ln -s ../bin/mpirun mpirun )"
-echo "/bin/rm -f $PREFIX/examples/mpirun" >> $UNINSTALLFILE
+echo "/bin/rm -f $PREFIX/share/examples/mpi/mpirun" >> $UNINSTALLFILE
 #
-echo "About to run installation test..."
-$Show "(cd $PREFIX/examples; $MAKE all )"
+#echo "About to run installation test..."
+#$Show "(cd $PREFIX/share/examples/mpi; $MAKE all )"
 #
 # This SHOULD use mpireconfig...
 Savevar=$PREFIX
 if [ -n "$CPP_DIR" -a "$buildcpp" = 1 ] ; then 
     # C++ Example programs 
-    CopyFile installtest/mpi-2-c++/Makefile.in $PREFIX/$CPP_DIR/examples
+    CopyFile installtest/mpi-2-c++/Makefile.in $PREFIX/share/examples/$CPP_DIR
     #
     PREFIX=$APREFIX
-    (cd $PREFIX/$CPP_DIR/examples ; $PREFIX/lib/$ARCH/$COMM/mpireconfig Makefile )
-    echo "(cd $PREFIX/$CPP_DIR/examples ; $MAKE clean)" >> $UNINSTALLFILE
-    echo "/bin/rm -f $PREFIX/$CPP_DIR/examples/Makefile" >> $UNINSTALLFILE
+    (cd $PREFIX/share/examples/$CPP_DIR ; $PREFIX/libdata/$ARCH/$COMM/mpireconfig Makefile )
+    echo "(cd $PREFIX/share/examples/$CPP_DIR ; $MAKE clean)" >> $UNINSTALLFILE
+    echo "/bin/rm -f $PREFIX/share/examples/$CPP_DIR/Makefile" >> $UNINSTALLFILE
     PREFIX=$Savevar
-    CopyFile $CPP_DIR/contrib/examples/hello_world.cc $PREFIX/$CPP_DIR/examples
-    CopyFile $CPP_DIR/contrib/examples/ring.cc $PREFIX/$CPP_DIR/examples
-    CopyFile $CPP_DIR/contrib/examples/topology.cc $PREFIX/$CPP_DIR/examples
-    CopyFile $CPP_DIR/contrib/examples/user_bcast.cc $PREFIX/$CPP_DIR/examples
-    CopyFile $CPP_DIR/contrib/examples/chapter_10_mpi2.cc $PREFIX/$CPP_DIR/examples
-    CopyFile $CPP_DIR/contrib/examples/pi.cc $PREFIX/$CPP_DIR/examples
-    CopyFile $CPP_DIR/contrib/examples/README $PREFIX/$CPP_DIR/examples
+    CopyFile $CPP_DIR/contrib/examples/hello_world.cc $PREFIX/share/examples/$CPP_DIR
+    CopyFile $CPP_DIR/contrib/examples/ring.cc $PREFIX/share/examples/$CPP_DIR
+    CopyFile $CPP_DIR/contrib/examples/topology.cc $PREFIX/share/examples/$CPP_DIR
+    CopyFile $CPP_DIR/contrib/examples/user_bcast.cc $PREFIX/share/examples/$CPP_DIR
+    CopyFile $CPP_DIR/contrib/examples/chapter_10_mpi2.cc $PREFIX/share/examples/$CPP_DIR
+    CopyFile $CPP_DIR/contrib/examples/pi.cc $PREFIX/share/examples/$CPP_DIR
+    CopyFile $CPP_DIR/contrib/examples/README $PREFIX/share/examples/$CPP_DIR
     #
     # Test build the C++ examples
-    $Show "(cd $PREFIX/$CPP_DIR/examples ; /bin/rm -f mpirun ; \
+    $Show "(cd $PREFIX/share/examples/$CPP_DIR ; /bin/rm -f mpirun ; \
 	      ln -s ../../bin/mpirun mpirun )"
-    echo "/bin/rm -f $PREFIX/$CPP_DIR/examples/mpirun" >> $UNINSTALLFILE
+    echo "/bin/rm -f $PREFIX/share/examples/$CPP_DIR/mpirun" >> $UNINSTALLFILE
     #
-    echo "About to run C++ installation test..."
-    $Show "(cd $PREFIX/$CPP_DIR/examples; $MAKE)"
+    #echo "About to run C++ installation test..."
+    #$Show "(cd $PREFIX/share/examples/$CPP_DIR; $MAKE)"
     #
 fi
 #
