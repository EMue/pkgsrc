diff -ru ../original/src/Makefile.template ./src/Makefile.template
--- ../original/src/Makefile.template	Tue Oct  1 16:53:30 1996
+++ ./src/Makefile.template	Tue Nov 18 15:06:29 1997
@@ -97,7 +97,7 @@
 $(SDR_UI_FILES): tcl2c
 
 parsed_plugins.tcl: ../src/plugin2tcl.tcl
-	tclsh7.5 ../src/plugin2tcl.tcl
+	tclsh8.0 ../src/plugin2tcl.tcl
 
 libs.tcl: $(TK_LIBRARY_FILES)
 	cat $(TK_LIBRARY_FILES) | sed '/^[      ]*source[       ]/d' > libs.tcl
diff -ru ../original/src/iohandler.c ./src/iohandler.c
--- ../original/src/iohandler.c	Tue Oct 29 15:52:25 1996
+++ ./src/iohandler.c	Tue Nov 18 15:06:30 1997
@@ -131,7 +131,7 @@
         }
 	sockproc[fd] = callback;
 #else
-	Tcl_CreateFileHandler(Tcl_GetFile((ClientData)fd, TCL_UNIX_FD),
+	Tcl_CreateFileHandler(fd,
 			      mask, callback, (ClientData)fd);
 #endif
 }
@@ -144,6 +144,6 @@
 		(void) WSAAsyncSelect(fd, sockwin, 0, 0);
 	}
 #else
-	Tcl_DeleteFileHandler(Tcl_GetFile((ClientData)fd, TCL_UNIX_FD));
+	Tcl_DeleteFileHandler(fd);
 #endif
 }
diff -ru ../original/src/qfdes/qfDES-memory.c ./src/qfdes/qfDES-memory.c
--- ../original/src/qfdes/qfDES-memory.c	Fri Sep 27 17:23:28 1996
+++ ./src/qfdes/qfDES-memory.c	Tue Nov 18 16:50:44 1997
@@ -12,23 +12,34 @@
 
 #include <stdio.h>
 #include <memory.h>
-#include <malloc.h>
+#include <stdlib.h>
 #include <ctype.h>
 #include "qfDES.h"
 
+#if defined(USE_PERROR)
+#include <errno.h>
+#else
 #ifndef DEFINED_ERRLIST
  extern int sys_nerr;
  extern char *sys_errlist[];
 #endif
 extern int errno;
+#endif
 
-
+#if defined(USE_PERROR)
+#if defined(DEBUG)
+#define ERROR(s_) perror(s_ ", file " __FILE__ ", line " __LINE__)
+#else
+#define ERROR(s_) perror(s_)
+#endif
+#else
 #if defined(DEBUG)
 #define ERROR(s_) \
     fprintf(stderr, "%s: errno %d - %s [%s line %d]\n", s_, errno, errno < sys_nerr ? sys_errlist[errno] : "???", __FILE__, __LINE__)
 #else
 #define ERROR(s_) \
     fprintf(stderr, "%s: errno %d - %s\n", s_, errno, errno < sys_nerr ? sys_errlist[errno] : "???")
+#endif
 #endif
 
 extern
diff -ru ../original/src/sdr.h ./src/sdr.h
--- ../original/src/sdr.h	Fri Nov  1 10:57:45 1996
+++ ./src/sdr.h	Tue Nov 18 15:06:29 1997
@@ -8,9 +8,6 @@
 #include <winsock.h>
 #else
 #include <sys/socket.h>
-#include <netinet/in.h>
-#include <arpa/inet.h>
-#include <net/if.h>
 #include <sys/ioctl.h>
 #include <netdb.h>
 #include <pwd.h>
@@ -18,6 +15,9 @@
 #include <sys/types.h>
 #include <sys/stat.h>
 #include <ctype.h>
+#include <netinet/in.h>
+#include <net/if.h>
+#include <arpa/inet.h>
 #include <arpa/nameser.h>
 #include <resolv.h>
 #ifdef AIX41
@@ -26,7 +26,6 @@
 #endif
 #include <tcl.h>
 #include <tk.h>
-#include <malloc.h>
 #include <string.h>
 #include <fcntl.h>
 #include <errno.h>
@@ -147,10 +146,17 @@
 };
   
 struct sap_header {
+#if BYTE_ORDER == BIG_ENDIAN
   u_int version:3;
   u_int type:3;
   u_int enc:1;
   u_int compress:1;
+#else
+  u_int compress:1;
+  u_int enc:1;
+  u_int type:3;
+  u_int version:3;
+#endif
   u_int authlen:8;
   u_int msgid:16;
   u_int src;
