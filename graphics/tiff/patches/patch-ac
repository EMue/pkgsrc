$NetBSD: patch-ac,v 1.7 1999/05/20 22:23:29 tron Exp $

--- tools/Makefile.in.orig	Mon Jul 20 11:17:11 1998
+++ tools/Makefile.in	Mon Jul 20 11:43:58 1998
@@ -47,10 +47,10 @@
 IPATH	= -I. -I${SRCDIR} -I${LIBDIR}
 CFLAGS	= @ENVOPTS@ ${COPTS} ${OPTIMIZER} ${IPATH}
 #
-TIFFLIB	= ${DEPTH}/libtiff/libtiff.@DSOSUF@
+TIFFLIB	= ${DEPTH}/libtiff/libtiff.la
 LIBJPEG	= @LIBJPEG@
 LIBGZ	= @LIBGZ@
-LIBTIFF	= @TIFFLIBREF@
+LIBTIFF	= ../libtiff/libtiff.la
 LIBPORT	= @LIBPORT@
 MACHLIBS= @MACHDEPLIBS@
 LIBS	= ${LIBTIFF} ${LIBJPEG} ${LIBGZ} ${LIBPORT} ${MACHLIBS}
@@ -107,7 +107,7 @@
 	fi
 install: all
 	${INSTALL} -idb tiff.sw.tools -m 755 -dir @DIR_BIN@
-	${INSTALL} -idb tiff.sw.tools -m 755 -F @DIR_BIN@ -O ${TARGETS}
+	${LIBTOOL} ${BSD_INSTALL_PROGRAM} ${TARGETS} @DIR_BIN@
 	@if [ "@LIBIMAGE@" = yes ]; then \
 	    ${INSTALL} -idb tiff.sw.tools -m 755 -F @DIR_BIN@ -O sgi2tiff; \
 	else \
@@ -127,37 +127,37 @@
 #
 
 tiffinfo: tiffinfo.o ${TIFFLIB}
-	${CC} -o tiffinfo ${CFLAGS} tiffinfo.o ${LIBS}
+	${LIBTOOL} ${CC} -o tiffinfo ${CFLAGS} tiffinfo.o ${LIBS} ${LDFLAGS}
 tiffinfo.o: ${SRCDIR}/tiffinfo.c
 	${CC} -c ${CFLAGS} ${SRCDIR}/tiffinfo.c
 
 tiffcmp:tiffcmp.o ${TIFFLIB}
-	${CC} -o tiffcmp ${CFLAGS} tiffcmp.o ${LIBS}
+	${LIBTOOL} ${CC} -o tiffcmp ${CFLAGS} tiffcmp.o ${LIBS} ${LDFLAGS}
 tiffcmp.o: ${SRCDIR}/tiffcmp.c
 	${CC} -c ${CFLAGS} ${SRCDIR}/tiffcmp.c
 
 tiffcp:	tiffcp.o ${TIFFLIB}
-	${CC} -o tiffcp ${CFLAGS} tiffcp.o ${LIBS}
+	${LIBTOOL} ${CC} -o tiffcp ${CFLAGS} tiffcp.o ${LIBS} ${LDFLAGS}
 tiffcp.o: ${SRCDIR}/tiffcp.c
 	${CC} -c ${CFLAGS} ${SRCDIR}/tiffcp.c
 
 tiffdump: tiffdump.o
-	${CC} -o tiffdump ${CFLAGS} tiffdump.o ${LIBS}
+	${LIBTOOL} ${CC} -o tiffdump ${CFLAGS} tiffdump.o ${LIBS} ${LDFLAGS}
 tiffdump.o: ${SRCDIR}/tiffdump.c
 	${CC} -c ${CFLAGS} ${SRCDIR}/tiffdump.c
 
 tiffmedian: tiffmedian.o ${TIFFLIB}
-	${CC} -o tiffmedian ${CFLAGS} tiffmedian.o ${LIBS}
+	${LIBTOOL} ${CC} -o tiffmedian ${CFLAGS} tiffmedian.o ${LIBS} ${LDFLAGS}
 tiffmedian.o: ${SRCDIR}/tiffmedian.c
 	${CC} -c ${CFLAGS} ${SRCDIR}/tiffmedian.c
 
 tiffsplit: tiffsplit.o ${TIFFLIB}
-	${CC} -o tiffsplit ${CFLAGS} tiffsplit.o ${LIBS}
+	${LIBTOOL} ${CC} -o tiffsplit ${CFLAGS} tiffsplit.o ${LIBS} ${LDFLAGS}
 tiffsplit.o: ${SRCDIR}/tiffsplit.c
 	${CC} -c ${CFLAGS} ${SRCDIR}/tiffsplit.c
 
 tiff2ps: tiff2ps.o ${TIFFLIB}
-	${CC} -o tiff2ps ${CFLAGS} tiff2ps.o ${LIBS}
+	${LIBTOOL} ${CC} -o tiff2ps ${CFLAGS} tiff2ps.o ${LIBS} ${LDFLAGS}
 tiff2ps.o: ${SRCDIR}/tiff2ps.c
 	${CC} -c ${CFLAGS} ${SRCDIR}/tiff2ps.c
 
@@ -168,61 +168,61 @@
 
 # convert RGB image to B&W
 tiff2bw: tiff2bw.o ${TIFFLIB}
-	${CC} -o tiff2bw ${CFLAGS} tiff2bw.o ${LIBS}
+	${LIBTOOL} ${CC} -o tiff2bw ${CFLAGS} tiff2bw.o ${LIBS} ${LDFLAGS}
 tiff2bw.o: ${SRCDIR}/tiff2bw.c
 	${CC} -c ${CFLAGS} ${SRCDIR}/tiff2bw.c
 
 # convert B&W image to bilevel w/ FS dithering
 tiffdither: tiffdither.o ${TIFFLIB}
-	${CC} -o tiffdither ${CFLAGS} tiffdither.o ${LIBS}
+	${LIBTOOL} ${CC} -o tiffdither ${CFLAGS} tiffdither.o ${LIBS} ${LDFLAGS}
 tiffdither.o: ${SRCDIR}/tiffdither.c
 	${CC} -c ${CFLAGS} ${SRCDIR}/tiffdither.c
 
 # simple Sun rasterfile converter
 ras2tiff: ras2tiff.o ${TIFFLIB}
-	${CC} -o ras2tiff ${CFLAGS} ras2tiff.o ${LIBS}
+	${LIBTOOL} ${CC} -o ras2tiff ${CFLAGS} ras2tiff.o ${LIBS} ${LDFLAGS}
 ras2tiff.o: ${SRCDIR}/ras2tiff.c
 	${CC} -c ${CFLAGS} ${SRCDIR}/ras2tiff.c
 
 # simple GIF converter
 gif2tiff: gif2tiff.o ${TIFFLIB}
-	${CC} -o gif2tiff ${CFLAGS} gif2tiff.o ${LIBS}
+	${LIBTOOL} ${CC} -o gif2tiff ${CFLAGS} gif2tiff.o ${LIBS} ${LDFLAGS}
 gif2tiff.o: ${SRCDIR}/gif2tiff.c
 	${CC} -c ${CFLAGS} ${SRCDIR}/gif2tiff.c
 
 # very limited PBM converter
 ppm2tiff: ppm2tiff.o ${TIFFLIB}
-	${CC} -o ppm2tiff ${CFLAGS} ppm2tiff.o ${LIBS}
+	${LIBTOOL} ${CC} -o ppm2tiff ${CFLAGS} ppm2tiff.o ${LIBS} ${LDFLAGS}
 ppm2tiff.o: ${SRCDIR}/ppm2tiff.c
 	${CC} -c ${CFLAGS} ${SRCDIR}/ppm2tiff.c
 
 # Group 3/4 FAX file converter
 fax2tiff: fax2tiff.o ${TIFFLIB}
-	${CC} -o fax2tiff ${CFLAGS} fax2tiff.o ${LIBS}
+	${LIBTOOL} ${CC} -o fax2tiff ${CFLAGS} fax2tiff.o ${LIBS} ${LDFLAGS}
 fax2tiff.o: ${SRCDIR}/fax2tiff.c
 	${CC} -c -I${LIBDIR} -I${DEPTH}/libtiff ${CFLAGS} ${SRCDIR}/fax2tiff.c
 
 # Group 3/4 FAX to encoded PS converter
 fax2ps: fax2ps.o ${TIFFLIB}
-	${CC} -o fax2ps ${CFLAGS} fax2ps.o ${LIBS}
+	${LIBTOOL} ${CC} -o fax2ps ${CFLAGS} fax2ps.o ${LIBS} ${LDFLAGS}
 fax2ps.o: ${SRCDIR}/fax2ps.c
 	${CC} -c ${CFLAGS} ${SRCDIR}/fax2ps.c
 
 # convert Palette image to RGB
 pal2rgb: pal2rgb.o ${TIFFLIB}
-	${CC} -o pal2rgb ${CFLAGS} pal2rgb.o ${LIBS}
+	${LIBTOOL} ${CC} -o pal2rgb ${CFLAGS} pal2rgb.o ${LIBS} ${LDFLAGS}
 pal2rgb.o: ${SRCDIR}/pal2rgb.c
 	${CC} -c ${CFLAGS} ${SRCDIR}/pal2rgb.c
 
 # convert RGB image to YCbCr
 rgb2ycbcr: rgb2ycbcr.o ${TIFFLIB}
-	${CC} -o rgb2ycbcr ${CFLAGS} rgb2ycbcr.o ${LIBS}
+	${LIBTOOL} ${CC} -o rgb2ycbcr ${CFLAGS} rgb2ycbcr.o ${LIBS} ${LDFLAGS}
 rgb2ycbcr.o: ${SRCDIR}/rgb2ycbcr.c
 	${CC} -c ${CFLAGS} ${SRCDIR}/rgb2ycbcr.c
 
 # generate thumbnail images from fax (example of SubIFD usage)
 thumbnail: thumbnail.o ${TIFFLIB}
-	${CC} -o thumbnail ${CFLAGS} thumbnail.o ${LIBS}
+	${LIBTOOL} ${CC} -o thumbnail ${CFLAGS} thumbnail.o ${LIBS} ${LDFLAGS}
 thumbnail.o: ${SRCDIR}/thumbnail.c
 	${CC} -c ${CFLAGS} ${SRCDIR}/thumbnail.c
 
