$NetBSD: patch-aa,v 1.14 2001/06/19 04:21:04 jlam Exp $

--- Makefile.config.orig	Thu Jun 22 13:48:03 2000
+++ Makefile.config	Fri Jun 15 17:42:45 2001
@@ -29,8 +29,8 @@
 #
 # For cygwin, only static libraries work, so set STATICLIB = Y  .
 
-STATICLIB = N
-#STATICLIB = Y
+#STATICLIB = N
+STATICLIB = Y
 
 # The following are commands for the build process to use.  These values
 # do not get built into anything.
@@ -39,19 +39,20 @@
 #Tru64:
 #CC =		cc
 #CC =		gcc
-CC =		gcc
+#CC =		gcc
 
 # The linker.
-LD = $(CC)
+#LD = $(CC)
 #LD = ld
 #Tru64:
 #LD = cc
 #LD = gcc 
+LD = $(LIBTOOL) --mode=link $(CC)
 
 # MAKE is set automatically by Make to what was used to invoke Make.
 SHELL =	/bin/sh
 
-INSTALL = ginstall
+#INSTALL = ginstall
 # Solaris:
 #INSTALL = /usr/ucb/install
 #Tru64:
@@ -59,7 +60,7 @@
 #OSF1:
 #INSTALL = installosf
 # ?
-#INSTALL = install
+#INSTALL = install -c
 
 # Normally the man pages are installed using "install".  But via this
 # variable, you can use something else, for example a script that
@@ -79,7 +80,7 @@
 # -ansi and -Werror should work too, but are not included
 # by default because there's no point in daring the build to fail.
 # -pedantic isn't a problem because it causes at worst a warning.
-CFLAGS = -pedantic -O2 -Wall -Wno-uninitialized $(CDEBUG)
+CFLAGS += -pedantic -Wall -Wno-uninitialized $(CDEBUG)
 # On DEC Tru64 4.0F (at least), you need -DLONG_32 for ppmtompeg.
 #Tru64:
 #CFLAGS = -O2 -std1 DLONG_32 $(CDEBUG)
@@ -93,7 +94,7 @@
   
 # linker options.  
 
-LDFLAGS =
+#LDFLAGS =
 # Eunice users may want to use -noshare so that the executables can
 # run standalone:
 #LDFLAGS = -noshare
@@ -148,11 +149,11 @@
 # but otherwise will not.
 
 # Use the Tiff library included with Netpbm:
-TIFFHDR_DIR = $(SRCDIR)/libtiff
-TIFFLIB_DIR = $(SRCDIR)/libtiff
+#TIFFHDR_DIR = $(SRCDIR)/libtiff
+#TIFFLIB_DIR = $(SRCDIR)/libtiff
 #NetBSD:
-#TIFFHDR_DIR = $(LOCALBASE)/include
-#TIFFLIB_DIR = $(LOCALBASE)/lib
+TIFFHDR_DIR = ${BUILDLINK_DIR}/include
+TIFFLIB_DIR = ${BUILDLINK_DIR}/lib
 # OSF, Tru64:
 #TIFFHDR_DIR = /usr/local1/DEC/include
 #TIFFLIB_DIR = /usr/local1/DEC/lib
@@ -173,11 +174,11 @@
 # at least JPEGLIB_DIR here, or the tiff converters will not build at
 # all.
 
-JPEGLIB_DIR = /usr/lib/jpeg
-JPEGHDR_DIR = /usr/include/jpeg
+#JPEGLIB_DIR = /usr/lib/jpeg
+#JPEGHDR_DIR = /usr/include/jpeg
 # Netbsd:
-#JPEGLIB_DIR = ${LOCALBASE}/lib
-#JPEGHDR_DIR = ${LOCALBASE}/include
+JPEGLIB_DIR = ${BUILDLINK_DIR}/lib
+JPEGHDR_DIR = ${BUILDLINK_DIR}/include
 # OSF, Tru64:
 #JPEGLIB_DIR = /usr/local1/DEC/lib
 #JPEGHDR_DIR = /usr/local1/DEC/include
@@ -195,11 +196,11 @@
 # here.  If you do not have the PNG library, and still want to
 # successully build everything else, put NONE for these.
 
-PNGLIB_DIR = /lib
-PNGHDR_DIR = /usr/include/png
+#PNGLIB_DIR = /lib
+#PNGHDR_DIR = /usr/include/png
 # NetBSD:
-#PNGLIB_DIR = $(LOCALBASE)/lib
-#PNGHDR_DIR = $(LOCALBASE)/include
+PNGLIB_DIR = ${BUILDLINK_DIR}/lib
+PNGHDR_DIR = ${BUILDLINK_DIR}/include
 # OSF/Tru64:
 #PNGLIB_DIR = /usr/local1/DEC/lib
 #PNGHDR_DIR = /usr/local1/DEC/include
@@ -222,7 +223,7 @@
 # network functions is the option in ppmtompeg to run it on multiple
 # computers simultaneously.
 
-NETWORKLD = 
+#NETWORKLD = 
 # Solaris, SunOS:
 #NETWORKLD = -lsocket -lnsl
 # Don't build network functions:
@@ -305,8 +306,8 @@
 #be a rule in the makefiles to make whatever the fliename turns out to be.
 #Only .a and .so work.
 ifeq ($(STATICLIB),Y)
-  NETPBMLIBSUFFIX = a
-  LIBTIFFSUFFIX = a
+  NETPBMLIBSUFFIX = la
+  LIBTIFFSUFFIX = la
 else
   NETPBMLIBSUFFIX = so
   LIBTIFFSUFFIX = so
