$NetBSD: patch-ak,v 1.3 2001/02/26 16:56:35 agc Exp $

--- lib/makefile.src.orig	Wed Mar  4 20:32:53 1992
+++ lib/makefile.src
@@ -9,6 +9,8 @@
 RANLIB = ranlib
 #endif
 
+CC= ${LIBTOOL} --mode=compile gcc
+
 # If nothing else is specified, default is to build the library.
 default: buildlib
 
@@ -36,40 +38,13 @@
 #  is more useful to have a non-debug version than nothing at all.)
 # Do nothing if $(DEST) is empty (or not defined)
 install: buildlib
-	@sh -c "if test '$(DEST)x' != x ; then \
-		echo cp $(LIBNAME) $(DEST)/$(LIBNAME) ; \
-		cp $(LIBNAME) $(DEST)/$(LIBNAME) ; \
-		if test x$(RANLIB) != x ; then \
-			echo ranlib $(DEST)/$(LIBNAME) ; \
-			ranlib $(DEST)/$(LIBNAME) ; \
-		else \
-			true ; \
-		fi ; \
-		if test -d $(DEST)/debug ; then \
-			echo cp $(LIBNAME) $(DEST)/debug/$(LIBNAME) ; \
-			if test x$(RANLIB) != x ; then \
-				cp $(LIBNAME) $(DEST)/debug/$(LIBNAME) ; \
-				echo ranlib $(DEST)/debug/$(LIBNAME) ; \
-			else \
-				true ; \
-			fi ; \
-			ranlib $(DEST)/debug/$(LIBNAME) ; \
-		else \
-			true ; \
-		fi ; \
-	else \
-		true ; \
-	fi"
+	${LIBTOOL} --mode=install ${BSD_INSTALL_DATA} ${LIBNAME:.a=.la} ${PREFIX}/lib
 	touch install
 
 # Rebuild the library from all the .o files.
 buildlib: $(OBJS)
 	-rm -f $(LIBNAME)
-	ar rc $(LIBNAME)
-	ar q $(LIBNAME) $(OBJS)
-#ifndef NO_RANLIB
-	ranlib $(LIBNAME)
-#endif
+	${LIBTOOL} --mode=link cc -o ${LIBNAME:.a=.la} ${OBJS:.o=.lo} -rpath ${PREFIX}/lib -version-info 1:0
 	touch buildlib
 
 # Clean up installed stuff and binaries
