$NetBSD: patch-ab,v 1.3 2000/01/04 15:34:54 agc Exp $

--- source/unix/makefile	1999/11/22 15:47:05	1.1
+++ source/unix/makefile	1999/11/22 15:59:05
@@ -50,8 +50,10 @@
 # Linux compiler flags, Pentium optimized
 #CFLAGS      = -O6 -finline-functions -ffast-math -c -ansi -m386 -DCPU=586 -DCOMPILER_VER=\".`uname`.$(CC)\" -DPOV_LIB_DIR=\"$(POVLIBDIR)\" $(SRCINC) $(LIBPNGINC) $(ZLIBINC)
 
+OPSYS!= uname -s
+
 # Linux compiler flags, Pentium II optimized
-CFLAGS      = -O6 -finline-functions -ffast-math -c -ansi -m386 -DCPU=686 -DCOMPILER_VER=\".`uname`.$(CC)\" -DPOV_LIB_DIR=\"$(POVLIBDIR)\" $(SRCINC) $(LIBPNGINC) $(ZLIBINC)
+CFLAGS      = -O2 -c -ansi -DCOMPILER_VER=\".${OPSYS}.$(CC)\" -DPOV_LIB_DIR=\"$(POVLIBDIR)\" $(SRCINC) $(LIBPNGINC) $(ZLIBINC)
 
 # HPUX compiler flags
 #CFLAGS      = +O2 -finline-functions -c -Aa -D_HPUX_SOURCE -DCOMPILER_VER=\".`uname`.$(CC)\" $(SRCINC) $(LIBPNGINC) $(ZLIBINC)
@@ -68,7 +70,7 @@
 #   different for each platform without having to change the makefile.
 # If you already have it set, comment all of these lines out.  Otherwise,
 #   uncomment one of the following lines, or edit one to suit your system.
-#X11 = /usr/local/X11R6
+X11 = ${X11BASE}
 
 # for some SunOS systems:
 #X11 = /usr/openwin
@@ -76,23 +78,23 @@
 # for some AIX systems:
 #X11 = /usr/lpp/X11
 
-X11 = /usr/X11R6
+#X11 = /usr/X11R6
 
 # You probably won't need to change these if you have the X11 variable
 #   above set properly...
 XLIBINC = -I$(X11)/include
-XLIBLIB = -L$(X11)/lib -lX11
+XLIBLIB = -L$(X11)/lib -Wl,-R${X11}/lib -lX11
 
 # libpng and zlib include and library directories.
 #
 # Use libXXX.a if you want to force static linking of the libraries.
 #   Use -Llibdir -lXXX if you want to use shared libraries (if they are
 #   available).  It doesn't matter if you only have libXXX.a libraries.
-PNGDIR = $(SRCDIR)/libpng
-LIBPNGINC = -I$(PNGDIR)
+PNGDIR =
+LIBPNGINC = -I${PREFIX}/include
 #LIBPNGLIB = $(PNGDIR)/libpng.a
-LIBPNGLIB = -L$(PNGDIR) -lpng
-#LIBPNGLIB = -L/usr/local/lib -lpng
+#LIBPNGLIB = -L$(PNGDIR) -lpng
+LIBPNGLIB = -L${PREFIX}/lib -Wl,-R${PREFIX}/lib -lpng
 
 # The following options are added at the suggestion of Axel Hecht
 # Modify png_povDEP accordingly if you use this option
@@ -101,10 +103,10 @@
 # LIBPNGINC = -I$(LIBPNGINCDIR)
 # LIBPNGLIB = -L$(PREFIX)/lib -lpng
 
-ZLIBDIR = $(SRCDIR)/zlib
-ZLIBINC = -I$(ZLIBDIR)
+#ZLIBDIR = $(SRCDIR)/zlib
+#ZLIBINC = -I$(ZLIBDIR)
 #ZLIBLIB = $(ZLIBDIR)/libz.a
-ZLIBLIB = -L$(ZLIBDIR) -lz
+ZLIBLIB = -lz
 #ZLIBLIB = -L/usr/local/lib -lz
 
 # The following options are added at the suggestion of Axel Hecht
@@ -127,12 +129,12 @@
 #default: svga
 
 # Define the default POV-Ray library location
-POVLIBDIR = /usr/local/lib/povray31
+POVLIBDIR = ${LOCALBASE}/lib/povray31
 
 # Define the path under which you want POV-Ray files to be installed,
 # typically /usr/local/bin, though Linux distributions may wish to 
 # alter this to /usr/bin
-POVPATH = /usr/local
+POVPATH = ${LOCALBASE}/bin
 
 #----------------------------------------------------------------------
 # There should be no compelling reason to customize the makefile beyond
@@ -1021,7 +1023,6 @@
                           config.h             \
                           $(SRCDIR)/frame.h    \
                           $(SRCDIR)/optout.h   \
-                          $(PNGDIR)/png.h      \
                           $(SRCDIR)/png_pov.h  \
                           $(SRCDIR)/point.h    \
                           $(SRCDIR)/povproto.h \
