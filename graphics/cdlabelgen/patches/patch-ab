$NetBSD: patch-ab,v 1.3 2000/09/01 20:42:56 jlam Exp $

--- Makefile.orig	Sun Jul  4 18:44:37 1999
+++ Makefile	Fri Sep  1 16:34:47 2000
@@ -4,31 +4,34 @@
 
 # Where you want cdlabelgen and related files to be
 
-BASE_DIR   = /usr/local
+BASE_DIR   = ${PREFIX}
 TEMPLATE   = ./postscript/template.ps
 SOURCES    = cdlabelgen ChangeLog COPYING INSTALL README Makefile
 POSTSCRIPT = template.ps recycle.ps recycle.epsi mp3.eps cdda.eps     \
 				 cd.eps penguin.eps debian-color.eps debian-bw.eps
 DISTFILES = $(SOURCES) $(POSTSCRIPT)
 
-# just use 'cp -a' if you don't have install...
-INSTALL		:= install -m 0755
-INSTALL_DIR	:= install -d -m 0755
-INSTALL_FILE	:= install -m 0644
-
 all: cdlabelgen
+	${SED} s=@PREFIX@=${PREFIX}=g <cdlabelgen >cdlabelgen.new
+	${MV} cdlabelgen.new cdlabelgen
+	if [ `id -u` -eq 0 ]; then	\
+		perldoc_flags="-U";	\
+	else				\
+		perldoc_flags="";	\
+	fi;				\
+	${LOCALBASE}/bin/perldoc $${perldoc_flags} cdlabelgen >cdlabelgen.0
 
 ###
 install: 
-	@echo "Installing cdlabelgen under $(BASE_DIR)"
+	@echo "Installing cdlabelgen under ${BASE_DIR}"
 	@echo ""
-	$(INSTALL_DIR) $(BASE_DIR)/bin
-	$(INSTALL) cdlabelgen $(BASE_DIR)/bin
-	$(INSTALL_DIR) $(BASE_DIR)/share/cdlabelgen
-	$(INSTALL_FILE) $(TEMPLATE) $(BASE_DIR)/share/cdlabelgen
+	${INSTALL_SCRIPT} cdlabelgen ${BASE_DIR}/bin/cdlabelgen
+	mkdir ${BASE_DIR}/share/cdlabelgen
+	${INSTALL_DATA} $(TEMPLATE) ${BASE_DIR}/share/cdlabelgen/
+	${INSTALL_MAN} cdlabelgen.0 ${BASE_DIR}/man/cat1/
 	set -e; \
 	for file in $(POSTSCRIPT); do \
-		$(INSTALL_FILE) postscript/$$file $(BASE_DIR)/share/cdlabelgen/; \
+		${INSTALL_DATA} postscript/$$file ${BASE_DIR}/share/cdlabelgen/; \
 	done
 
 dist: 
